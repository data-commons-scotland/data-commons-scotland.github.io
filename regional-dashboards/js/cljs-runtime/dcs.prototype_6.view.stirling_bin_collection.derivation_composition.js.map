{"version":3,"sources":["dcs/prototype_6/view/stirling_bin_collection/derivation_composition.cljs"],"mappings":";AAOA,AAAA,AAAMA,AAAYC,AAAMC;AAAxB,AACM,AAAMC,AAAW,AAACC,AAAM,AAAA,AAACC,AAAeH;AAAxC,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAM2BA,AASoBC;;AAYrD,AAAA,AAAMG,AAAOC;AAAb,AACM,AACMC,AAAwB,AAAA,AAAAC,AAACC;AAAD,AAAM,AAAAD,AAAA,AAACE,AAAc,AAAK,AAAA,AAAAF;AACrBF;AAFnC,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAKOK,AAAa,AAAA,AAACZ,AAAyBQ;;AAGpD,AAAA,AAAMM;AAAN,AAAA,AAAA,AAAAD,AACOP,AACCS","names":["dcs.prototype-6.view.stirling-bin-collection.derivation-composition/chart-spec","title","data","year-count","cljs.core/count","cljs.core/group-by","dcs.prototype-6.view.stirling-bin-collection.derivation-composition/chart","derivation-composition","derivation-composition'","p1__32570#","cljs.core.map","cljs.core.assoc","oz.core/vega-lite","cljs.core/deref","dcs.prototype-6.view.stirling-bin-collection.derivation-composition/root","dcs.prototype-6.state/stirling-bin-collection-derivation-composition-holder"],"sourcesContent":["(ns dcs.prototype-6.view.stirling-bin-collection.derivation-composition\n  (:require\n    [reagent.core :as r]\n    [oz.core :as oz]\n    [dcs.prototype-6.state :as state]))\n\n\n(defn chart-spec [title data]\n      (let [year-count (count (group-by :year data))]\n           {:schema     \"https://vega.github.io/schema/vega/v5.json\"\n            ;;:title      title\n            :width      200\n            :height     100\n            :background \"floralwhite\"\n            :data       {:values data}\n            :mark       {:type                 \"bar\"\n                         :cornerRadiusTopLeft  3\n                         :cornerRadiusTopRight 3}\n            :selection  {:my {:type   \"multi\"\n                              :fields [\"region\"]\n                              :bind   \"legend\"}}\n            :encoding   {:x       {:field \"year\" :type \"temporal\"\n                                   :timeUnit \"year\"\n                                   :axis {:tickCount year-count :title \"year\"}}\n                         :y       {:field \"tonnes\" :type \"quantitative\"\n                                   :scale {:zero false}\n                                   :axis {:title \"tonnes per citizen\"}}\n                         :color   {:field \"material\" :type \"nominal\"\n                                   :scale {:scheme \"tableau20\"}}\n                         :opacity {:condition {:selection \"my\" :value 1}\n                                   :value     0.2}\n                         :tooltip [{:field \"material\" :type \"nominal\"}\n                                   {:field \"year\" :type \"temporal\"}\n                                   {:field \"tonnes\" :type \"quantitative\" :title \"tonnes per citizen\"}]}}))\n\n(defn chart [derivation-composition]\n      (let [;; stringify the year for Vega\n            derivation-composition' (map #(assoc % :year (str (:year %)))\n                                         derivation-composition)]\n\n           [:div\n            [oz/vega-lite (chart-spec \"Composition\" derivation-composition')\n             {:actions false}]]))\n\n(defn root []\n      [chart\n       @state/stirling-bin-collection-derivation-composition-holder])"]}