goog.provide('dcs.prototype_6.state');
if((typeof dcs !== 'undefined') && (typeof dcs.prototype_6 !== 'undefined') && (typeof dcs.prototype_6.state !== 'undefined') && (typeof dcs.prototype_6.state.app_state !== 'undefined')){
} else {
dcs.prototype_6.state.app_state = reagent.core.atom.cljs$core$IFn$_invoke$arity$1(new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"count","count",2139924085),(0)], null));
}
if((typeof dcs !== 'undefined') && (typeof dcs.prototype_6 !== 'undefined') && (typeof dcs.prototype_6.state !== 'undefined') && (typeof dcs.prototype_6.state.region_holder !== 'undefined')){
} else {
dcs.prototype_6.state.region_holder = reagent.core.atom.cljs$core$IFn$_invoke$arity$1("Please select a region...");
}
if((typeof dcs !== 'undefined') && (typeof dcs.prototype_6 !== 'undefined') && (typeof dcs.prototype_6.state !== 'undefined') && (typeof dcs.prototype_6.state.geojson_holder !== 'undefined')){
} else {
dcs.prototype_6.state.geojson_holder = reagent.core.atom.cljs$core$IFn$_invoke$arity$1(null);
}
if((typeof dcs !== 'undefined') && (typeof dcs.prototype_6 !== 'undefined') && (typeof dcs.prototype_6.state !== 'undefined') && (typeof dcs.prototype_6.state.household_waste_derivation_generation_holder !== 'undefined')){
} else {
dcs.prototype_6.state.household_waste_derivation_generation_holder = reagent.core.atom.cljs$core$IFn$_invoke$arity$1(null);
}
if((typeof dcs !== 'undefined') && (typeof dcs.prototype_6 !== 'undefined') && (typeof dcs.prototype_6.state !== 'undefined') && (typeof dcs.prototype_6.state.household_waste_derivation_percent_recycled_holder !== 'undefined')){
} else {
dcs.prototype_6.state.household_waste_derivation_percent_recycled_holder = reagent.core.atom.cljs$core$IFn$_invoke$arity$1(null);
}
if((typeof dcs !== 'undefined') && (typeof dcs.prototype_6 !== 'undefined') && (typeof dcs.prototype_6.state !== 'undefined') && (typeof dcs.prototype_6.state.household_waste_derivation_management_holder !== 'undefined')){
} else {
dcs.prototype_6.state.household_waste_derivation_management_holder = reagent.core.atom.cljs$core$IFn$_invoke$arity$1(null);
}
if((typeof dcs !== 'undefined') && (typeof dcs.prototype_6 !== 'undefined') && (typeof dcs.prototype_6.state !== 'undefined') && (typeof dcs.prototype_6.state.household_waste_derivation_composition_holder !== 'undefined')){
} else {
dcs.prototype_6.state.household_waste_derivation_composition_holder = reagent.core.atom.cljs$core$IFn$_invoke$arity$1(null);
}
if((typeof dcs !== 'undefined') && (typeof dcs.prototype_6 !== 'undefined') && (typeof dcs.prototype_6.state !== 'undefined') && (typeof dcs.prototype_6.state.household_waste_derivation_generation_positions_holder !== 'undefined')){
} else {
dcs.prototype_6.state.household_waste_derivation_generation_positions_holder = reagent.core.atom.cljs$core$IFn$_invoke$arity$1(null);
}
if((typeof dcs !== 'undefined') && (typeof dcs.prototype_6 !== 'undefined') && (typeof dcs.prototype_6.state !== 'undefined') && (typeof dcs.prototype_6.state.household_waste_derivation_percent_recycled_positions_holder !== 'undefined')){
} else {
dcs.prototype_6.state.household_waste_derivation_percent_recycled_positions_holder = reagent.core.atom.cljs$core$IFn$_invoke$arity$1(null);
}
if((typeof dcs !== 'undefined') && (typeof dcs.prototype_6 !== 'undefined') && (typeof dcs.prototype_6.state !== 'undefined') && (typeof dcs.prototype_6.state.household_co2e_derivation_generation_holder !== 'undefined')){
} else {
dcs.prototype_6.state.household_co2e_derivation_generation_holder = reagent.core.atom.cljs$core$IFn$_invoke$arity$1(null);
}
if((typeof dcs !== 'undefined') && (typeof dcs.prototype_6 !== 'undefined') && (typeof dcs.prototype_6.state !== 'undefined') && (typeof dcs.prototype_6.state.household_co2e_derivation_generation_positions_holder !== 'undefined')){
} else {
dcs.prototype_6.state.household_co2e_derivation_generation_positions_holder = reagent.core.atom.cljs$core$IFn$_invoke$arity$1(null);
}
if((typeof dcs !== 'undefined') && (typeof dcs.prototype_6 !== 'undefined') && (typeof dcs.prototype_6.state !== 'undefined') && (typeof dcs.prototype_6.state.business_waste_by_region_derivation_generation_holder !== 'undefined')){
} else {
dcs.prototype_6.state.business_waste_by_region_derivation_generation_holder = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(null);
}
if((typeof dcs !== 'undefined') && (typeof dcs.prototype_6 !== 'undefined') && (typeof dcs.prototype_6.state !== 'undefined') && (typeof dcs.prototype_6.state.business_waste_by_region_derivation_composition_holder !== 'undefined')){
} else {
dcs.prototype_6.state.business_waste_by_region_derivation_composition_holder = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(null);
}
if((typeof dcs !== 'undefined') && (typeof dcs.prototype_6 !== 'undefined') && (typeof dcs.prototype_6.state !== 'undefined') && (typeof dcs.prototype_6.state.waste_site_derivation_holder !== 'undefined')){
} else {
dcs.prototype_6.state.waste_site_derivation_holder = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(null);
}
if((typeof dcs !== 'undefined') && (typeof dcs.prototype_6 !== 'undefined') && (typeof dcs.prototype_6.state !== 'undefined') && (typeof dcs.prototype_6.state.population_holder !== 'undefined')){
} else {
dcs.prototype_6.state.population_holder = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(null);
}
if((typeof dcs !== 'undefined') && (typeof dcs.prototype_6 !== 'undefined') && (typeof dcs.prototype_6.state !== 'undefined') && (typeof dcs.prototype_6.state.household_waste_holder !== 'undefined')){
} else {
dcs.prototype_6.state.household_waste_holder = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(null);
}
if((typeof dcs !== 'undefined') && (typeof dcs.prototype_6 !== 'undefined') && (typeof dcs.prototype_6.state !== 'undefined') && (typeof dcs.prototype_6.state.household_co2e_holder !== 'undefined')){
} else {
dcs.prototype_6.state.household_co2e_holder = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(null);
}
if((typeof dcs !== 'undefined') && (typeof dcs.prototype_6 !== 'undefined') && (typeof dcs.prototype_6.state !== 'undefined') && (typeof dcs.prototype_6.state.business_waste_by_region_holder !== 'undefined')){
} else {
dcs.prototype_6.state.business_waste_by_region_holder = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(null);
}
if((typeof dcs !== 'undefined') && (typeof dcs.prototype_6 !== 'undefined') && (typeof dcs.prototype_6.state !== 'undefined') && (typeof dcs.prototype_6.state.waste_site_holder !== 'undefined')){
} else {
dcs.prototype_6.state.waste_site_holder = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(null);
}
console.log("load geojson");
var c__25757__auto___27478 = cljs.core.async.chan.cljs$core$IFn$_invoke$arity$1((1));
cljs.core.async.impl.dispatch.run((function (){
var f__25758__auto__ = (function (){var switch__25734__auto__ = (function (state_27334){
var state_val_27335 = (state_27334[(1)]);
if((state_val_27335 === (1))){
var inst_27323 = cljs_http.client.get("geojson.json");
var state_27334__$1 = state_27334;
return cljs.core.async.impl.ioc_helpers.take_BANG_(state_27334__$1,(2),inst_27323);
} else {
if((state_val_27335 === (2))){
var inst_27325 = (state_27334[(2)]);
var inst_27326 = new cljs.core.Keyword(null,"status","status",-1997798413).cljs$core$IFn$_invoke$arity$1(inst_27325);
var inst_27327 = new cljs.core.Keyword(null,"success","success",1890645906).cljs$core$IFn$_invoke$arity$1(inst_27325);
var inst_27328 = ["geojson, status=",cljs.core.str.cljs$core$IFn$_invoke$arity$1(inst_27326),", success=",cljs.core.str.cljs$core$IFn$_invoke$arity$1(inst_27327)].join('');
var inst_27329 = console.log(inst_27328);
var inst_27330 = new cljs.core.Keyword(null,"body","body",-2049205669).cljs$core$IFn$_invoke$arity$1(inst_27325);
var inst_27331 = cljs.core.clj__GT_js(inst_27330);
var inst_27332 = cljs.core.reset_BANG_(dcs.prototype_6.state.geojson_holder,inst_27331);
var state_27334__$1 = (function (){var statearr_27336 = state_27334;
(statearr_27336[(7)] = inst_27329);

return statearr_27336;
})();
return cljs.core.async.impl.ioc_helpers.return_chan(state_27334__$1,inst_27332);
} else {
return null;
}
}
});
return (function() {
var dcs$prototype_6$state$state_machine__25735__auto__ = null;
var dcs$prototype_6$state$state_machine__25735__auto____0 = (function (){
var statearr_27337 = [null,null,null,null,null,null,null,null];
(statearr_27337[(0)] = dcs$prototype_6$state$state_machine__25735__auto__);

(statearr_27337[(1)] = (1));

return statearr_27337;
});
var dcs$prototype_6$state$state_machine__25735__auto____1 = (function (state_27334){
while(true){
var ret_value__25736__auto__ = (function (){try{while(true){
var result__25737__auto__ = switch__25734__auto__(state_27334);
if(cljs.core.keyword_identical_QMARK_(result__25737__auto__,new cljs.core.Keyword(null,"recur","recur",-437573268))){
continue;
} else {
return result__25737__auto__;
}
break;
}
}catch (e27338){var ex__25738__auto__ = e27338;
var statearr_27339_27479 = state_27334;
(statearr_27339_27479[(2)] = ex__25738__auto__);


if(cljs.core.seq((state_27334[(4)]))){
var statearr_27340_27480 = state_27334;
(statearr_27340_27480[(1)] = cljs.core.first((state_27334[(4)])));

} else {
throw ex__25738__auto__;
}

return new cljs.core.Keyword(null,"recur","recur",-437573268);
}})();
if(cljs.core.keyword_identical_QMARK_(ret_value__25736__auto__,new cljs.core.Keyword(null,"recur","recur",-437573268))){
var G__27481 = state_27334;
state_27334 = G__27481;
continue;
} else {
return ret_value__25736__auto__;
}
break;
}
});
dcs$prototype_6$state$state_machine__25735__auto__ = function(state_27334){
switch(arguments.length){
case 0:
return dcs$prototype_6$state$state_machine__25735__auto____0.call(this);
case 1:
return dcs$prototype_6$state$state_machine__25735__auto____1.call(this,state_27334);
}
throw(new Error('Invalid arity: ' + arguments.length));
};
dcs$prototype_6$state$state_machine__25735__auto__.cljs$core$IFn$_invoke$arity$0 = dcs$prototype_6$state$state_machine__25735__auto____0;
dcs$prototype_6$state$state_machine__25735__auto__.cljs$core$IFn$_invoke$arity$1 = dcs$prototype_6$state$state_machine__25735__auto____1;
return dcs$prototype_6$state$state_machine__25735__auto__;
})()
})();
var state__25759__auto__ = (function (){var statearr_27341 = f__25758__auto__();
(statearr_27341[(6)] = c__25757__auto___27478);

return statearr_27341;
})();
return cljs.core.async.impl.ioc_helpers.run_state_machine_wrapped(state__25759__auto__);
}));

console.log("load population");
var c__25757__auto___27482 = cljs.core.async.chan.cljs$core$IFn$_invoke$arity$1((1));
cljs.core.async.impl.dispatch.run((function (){
var f__25758__auto__ = (function (){var switch__25734__auto__ = (function (state_27354){
var state_val_27355 = (state_27354[(1)]);
if((state_val_27355 === (1))){
var inst_27342 = cljs_http.client.get("population.json");
var state_27354__$1 = state_27354;
return cljs.core.async.impl.ioc_helpers.take_BANG_(state_27354__$1,(2),inst_27342);
} else {
if((state_val_27355 === (2))){
var inst_27344 = (state_27354[(2)]);
var inst_27345 = new cljs.core.Keyword(null,"status","status",-1997798413).cljs$core$IFn$_invoke$arity$1(inst_27344);
var inst_27346 = new cljs.core.Keyword(null,"success","success",1890645906).cljs$core$IFn$_invoke$arity$1(inst_27344);
var inst_27347 = ["population, status=",cljs.core.str.cljs$core$IFn$_invoke$arity$1(inst_27345),", success=",cljs.core.str.cljs$core$IFn$_invoke$arity$1(inst_27346)].join('');
var inst_27348 = console.log(inst_27347);
var inst_27349 = new cljs.core.Keyword(null,"body","body",-2049205669).cljs$core$IFn$_invoke$arity$1(inst_27344);
var inst_27350 = dcs.prototype_6.data_shaping.rollup_population_regions(inst_27349);
var inst_27351 = cljs.core.concat.cljs$core$IFn$_invoke$arity$2(inst_27349,inst_27350);
var inst_27352 = cljs.core.reset_BANG_(dcs.prototype_6.state.population_holder,inst_27351);
var state_27354__$1 = (function (){var statearr_27356 = state_27354;
(statearr_27356[(7)] = inst_27348);

return statearr_27356;
})();
return cljs.core.async.impl.ioc_helpers.return_chan(state_27354__$1,inst_27352);
} else {
return null;
}
}
});
return (function() {
var dcs$prototype_6$state$state_machine__25735__auto__ = null;
var dcs$prototype_6$state$state_machine__25735__auto____0 = (function (){
var statearr_27357 = [null,null,null,null,null,null,null,null];
(statearr_27357[(0)] = dcs$prototype_6$state$state_machine__25735__auto__);

(statearr_27357[(1)] = (1));

return statearr_27357;
});
var dcs$prototype_6$state$state_machine__25735__auto____1 = (function (state_27354){
while(true){
var ret_value__25736__auto__ = (function (){try{while(true){
var result__25737__auto__ = switch__25734__auto__(state_27354);
if(cljs.core.keyword_identical_QMARK_(result__25737__auto__,new cljs.core.Keyword(null,"recur","recur",-437573268))){
continue;
} else {
return result__25737__auto__;
}
break;
}
}catch (e27358){var ex__25738__auto__ = e27358;
var statearr_27359_27483 = state_27354;
(statearr_27359_27483[(2)] = ex__25738__auto__);


if(cljs.core.seq((state_27354[(4)]))){
var statearr_27360_27484 = state_27354;
(statearr_27360_27484[(1)] = cljs.core.first((state_27354[(4)])));

} else {
throw ex__25738__auto__;
}

return new cljs.core.Keyword(null,"recur","recur",-437573268);
}})();
if(cljs.core.keyword_identical_QMARK_(ret_value__25736__auto__,new cljs.core.Keyword(null,"recur","recur",-437573268))){
var G__27485 = state_27354;
state_27354 = G__27485;
continue;
} else {
return ret_value__25736__auto__;
}
break;
}
});
dcs$prototype_6$state$state_machine__25735__auto__ = function(state_27354){
switch(arguments.length){
case 0:
return dcs$prototype_6$state$state_machine__25735__auto____0.call(this);
case 1:
return dcs$prototype_6$state$state_machine__25735__auto____1.call(this,state_27354);
}
throw(new Error('Invalid arity: ' + arguments.length));
};
dcs$prototype_6$state$state_machine__25735__auto__.cljs$core$IFn$_invoke$arity$0 = dcs$prototype_6$state$state_machine__25735__auto____0;
dcs$prototype_6$state$state_machine__25735__auto__.cljs$core$IFn$_invoke$arity$1 = dcs$prototype_6$state$state_machine__25735__auto____1;
return dcs$prototype_6$state$state_machine__25735__auto__;
})()
})();
var state__25759__auto__ = (function (){var statearr_27361 = f__25758__auto__();
(statearr_27361[(6)] = c__25757__auto___27482);

return statearr_27361;
})();
return cljs.core.async.impl.ioc_helpers.run_state_machine_wrapped(state__25759__auto__);
}));

console.log("load household-waste");
var c__25757__auto___27486 = cljs.core.async.chan.cljs$core$IFn$_invoke$arity$1((1));
cljs.core.async.impl.dispatch.run((function (){
var f__25758__auto__ = (function (){var switch__25734__auto__ = (function (state_27374){
var state_val_27375 = (state_27374[(1)]);
if((state_val_27375 === (1))){
var inst_27362 = cljs_http.client.get("household-waste.json");
var state_27374__$1 = state_27374;
return cljs.core.async.impl.ioc_helpers.take_BANG_(state_27374__$1,(2),inst_27362);
} else {
if((state_val_27375 === (2))){
var inst_27364 = (state_27374[(2)]);
var inst_27365 = new cljs.core.Keyword(null,"status","status",-1997798413).cljs$core$IFn$_invoke$arity$1(inst_27364);
var inst_27366 = new cljs.core.Keyword(null,"success","success",1890645906).cljs$core$IFn$_invoke$arity$1(inst_27364);
var inst_27367 = ["household-waste, status=",cljs.core.str.cljs$core$IFn$_invoke$arity$1(inst_27365),", success=",cljs.core.str.cljs$core$IFn$_invoke$arity$1(inst_27366)].join('');
var inst_27368 = console.log(inst_27367);
var inst_27369 = new cljs.core.Keyword(null,"body","body",-2049205669).cljs$core$IFn$_invoke$arity$1(inst_27364);
var inst_27370 = dcs.prototype_6.data_shaping.rollup_household_waste_regions(inst_27369);
var inst_27371 = cljs.core.concat.cljs$core$IFn$_invoke$arity$2(inst_27369,inst_27370);
var inst_27372 = cljs.core.reset_BANG_(dcs.prototype_6.state.household_waste_holder,inst_27371);
var state_27374__$1 = (function (){var statearr_27376 = state_27374;
(statearr_27376[(7)] = inst_27368);

return statearr_27376;
})();
return cljs.core.async.impl.ioc_helpers.return_chan(state_27374__$1,inst_27372);
} else {
return null;
}
}
});
return (function() {
var dcs$prototype_6$state$state_machine__25735__auto__ = null;
var dcs$prototype_6$state$state_machine__25735__auto____0 = (function (){
var statearr_27377 = [null,null,null,null,null,null,null,null];
(statearr_27377[(0)] = dcs$prototype_6$state$state_machine__25735__auto__);

(statearr_27377[(1)] = (1));

return statearr_27377;
});
var dcs$prototype_6$state$state_machine__25735__auto____1 = (function (state_27374){
while(true){
var ret_value__25736__auto__ = (function (){try{while(true){
var result__25737__auto__ = switch__25734__auto__(state_27374);
if(cljs.core.keyword_identical_QMARK_(result__25737__auto__,new cljs.core.Keyword(null,"recur","recur",-437573268))){
continue;
} else {
return result__25737__auto__;
}
break;
}
}catch (e27378){var ex__25738__auto__ = e27378;
var statearr_27379_27487 = state_27374;
(statearr_27379_27487[(2)] = ex__25738__auto__);


if(cljs.core.seq((state_27374[(4)]))){
var statearr_27380_27488 = state_27374;
(statearr_27380_27488[(1)] = cljs.core.first((state_27374[(4)])));

} else {
throw ex__25738__auto__;
}

return new cljs.core.Keyword(null,"recur","recur",-437573268);
}})();
if(cljs.core.keyword_identical_QMARK_(ret_value__25736__auto__,new cljs.core.Keyword(null,"recur","recur",-437573268))){
var G__27489 = state_27374;
state_27374 = G__27489;
continue;
} else {
return ret_value__25736__auto__;
}
break;
}
});
dcs$prototype_6$state$state_machine__25735__auto__ = function(state_27374){
switch(arguments.length){
case 0:
return dcs$prototype_6$state$state_machine__25735__auto____0.call(this);
case 1:
return dcs$prototype_6$state$state_machine__25735__auto____1.call(this,state_27374);
}
throw(new Error('Invalid arity: ' + arguments.length));
};
dcs$prototype_6$state$state_machine__25735__auto__.cljs$core$IFn$_invoke$arity$0 = dcs$prototype_6$state$state_machine__25735__auto____0;
dcs$prototype_6$state$state_machine__25735__auto__.cljs$core$IFn$_invoke$arity$1 = dcs$prototype_6$state$state_machine__25735__auto____1;
return dcs$prototype_6$state$state_machine__25735__auto__;
})()
})();
var state__25759__auto__ = (function (){var statearr_27381 = f__25758__auto__();
(statearr_27381[(6)] = c__25757__auto___27486);

return statearr_27381;
})();
return cljs.core.async.impl.ioc_helpers.run_state_machine_wrapped(state__25759__auto__);
}));

console.log("load household-co2e");
var c__25757__auto___27490 = cljs.core.async.chan.cljs$core$IFn$_invoke$arity$1((1));
cljs.core.async.impl.dispatch.run((function (){
var f__25758__auto__ = (function (){var switch__25734__auto__ = (function (state_27394){
var state_val_27395 = (state_27394[(1)]);
if((state_val_27395 === (1))){
var inst_27382 = cljs_http.client.get("household-co2e.json");
var state_27394__$1 = state_27394;
return cljs.core.async.impl.ioc_helpers.take_BANG_(state_27394__$1,(2),inst_27382);
} else {
if((state_val_27395 === (2))){
var inst_27384 = (state_27394[(2)]);
var inst_27385 = new cljs.core.Keyword(null,"status","status",-1997798413).cljs$core$IFn$_invoke$arity$1(inst_27384);
var inst_27386 = new cljs.core.Keyword(null,"success","success",1890645906).cljs$core$IFn$_invoke$arity$1(inst_27384);
var inst_27387 = ["household-co2e, status=",cljs.core.str.cljs$core$IFn$_invoke$arity$1(inst_27385),", success=",cljs.core.str.cljs$core$IFn$_invoke$arity$1(inst_27386)].join('');
var inst_27388 = console.log(inst_27387);
var inst_27389 = new cljs.core.Keyword(null,"body","body",-2049205669).cljs$core$IFn$_invoke$arity$1(inst_27384);
var inst_27390 = dcs.prototype_6.data_shaping.rollup_household_co2e_regions(inst_27389);
var inst_27391 = cljs.core.concat.cljs$core$IFn$_invoke$arity$2(inst_27389,inst_27390);
var inst_27392 = cljs.core.reset_BANG_(dcs.prototype_6.state.household_co2e_holder,inst_27391);
var state_27394__$1 = (function (){var statearr_27396 = state_27394;
(statearr_27396[(7)] = inst_27388);

return statearr_27396;
})();
return cljs.core.async.impl.ioc_helpers.return_chan(state_27394__$1,inst_27392);
} else {
return null;
}
}
});
return (function() {
var dcs$prototype_6$state$state_machine__25735__auto__ = null;
var dcs$prototype_6$state$state_machine__25735__auto____0 = (function (){
var statearr_27397 = [null,null,null,null,null,null,null,null];
(statearr_27397[(0)] = dcs$prototype_6$state$state_machine__25735__auto__);

(statearr_27397[(1)] = (1));

return statearr_27397;
});
var dcs$prototype_6$state$state_machine__25735__auto____1 = (function (state_27394){
while(true){
var ret_value__25736__auto__ = (function (){try{while(true){
var result__25737__auto__ = switch__25734__auto__(state_27394);
if(cljs.core.keyword_identical_QMARK_(result__25737__auto__,new cljs.core.Keyword(null,"recur","recur",-437573268))){
continue;
} else {
return result__25737__auto__;
}
break;
}
}catch (e27398){var ex__25738__auto__ = e27398;
var statearr_27399_27491 = state_27394;
(statearr_27399_27491[(2)] = ex__25738__auto__);


if(cljs.core.seq((state_27394[(4)]))){
var statearr_27400_27492 = state_27394;
(statearr_27400_27492[(1)] = cljs.core.first((state_27394[(4)])));

} else {
throw ex__25738__auto__;
}

return new cljs.core.Keyword(null,"recur","recur",-437573268);
}})();
if(cljs.core.keyword_identical_QMARK_(ret_value__25736__auto__,new cljs.core.Keyword(null,"recur","recur",-437573268))){
var G__27493 = state_27394;
state_27394 = G__27493;
continue;
} else {
return ret_value__25736__auto__;
}
break;
}
});
dcs$prototype_6$state$state_machine__25735__auto__ = function(state_27394){
switch(arguments.length){
case 0:
return dcs$prototype_6$state$state_machine__25735__auto____0.call(this);
case 1:
return dcs$prototype_6$state$state_machine__25735__auto____1.call(this,state_27394);
}
throw(new Error('Invalid arity: ' + arguments.length));
};
dcs$prototype_6$state$state_machine__25735__auto__.cljs$core$IFn$_invoke$arity$0 = dcs$prototype_6$state$state_machine__25735__auto____0;
dcs$prototype_6$state$state_machine__25735__auto__.cljs$core$IFn$_invoke$arity$1 = dcs$prototype_6$state$state_machine__25735__auto____1;
return dcs$prototype_6$state$state_machine__25735__auto__;
})()
})();
var state__25759__auto__ = (function (){var statearr_27401 = f__25758__auto__();
(statearr_27401[(6)] = c__25757__auto___27490);

return statearr_27401;
})();
return cljs.core.async.impl.ioc_helpers.run_state_machine_wrapped(state__25759__auto__);
}));

console.log("load business-waste-by-region");
var c__25757__auto___27494 = cljs.core.async.chan.cljs$core$IFn$_invoke$arity$1((1));
cljs.core.async.impl.dispatch.run((function (){
var f__25758__auto__ = (function (){var switch__25734__auto__ = (function (state_27414){
var state_val_27415 = (state_27414[(1)]);
if((state_val_27415 === (1))){
var inst_27402 = cljs_http.client.get("business-waste-by-region.json");
var state_27414__$1 = state_27414;
return cljs.core.async.impl.ioc_helpers.take_BANG_(state_27414__$1,(2),inst_27402);
} else {
if((state_val_27415 === (2))){
var inst_27404 = (state_27414[(2)]);
var inst_27405 = new cljs.core.Keyword(null,"status","status",-1997798413).cljs$core$IFn$_invoke$arity$1(inst_27404);
var inst_27406 = new cljs.core.Keyword(null,"success","success",1890645906).cljs$core$IFn$_invoke$arity$1(inst_27404);
var inst_27407 = ["business-waste-by-region, status=",cljs.core.str.cljs$core$IFn$_invoke$arity$1(inst_27405),", success=",cljs.core.str.cljs$core$IFn$_invoke$arity$1(inst_27406)].join('');
var inst_27408 = console.log(inst_27407);
var inst_27409 = new cljs.core.Keyword(null,"body","body",-2049205669).cljs$core$IFn$_invoke$arity$1(inst_27404);
var inst_27410 = dcs.prototype_6.data_shaping.rollup_business_waste_by_region_regions(inst_27409);
var inst_27411 = cljs.core.concat.cljs$core$IFn$_invoke$arity$2(inst_27409,inst_27410);
var inst_27412 = cljs.core.reset_BANG_(dcs.prototype_6.state.business_waste_by_region_holder,inst_27411);
var state_27414__$1 = (function (){var statearr_27416 = state_27414;
(statearr_27416[(7)] = inst_27408);

return statearr_27416;
})();
return cljs.core.async.impl.ioc_helpers.return_chan(state_27414__$1,inst_27412);
} else {
return null;
}
}
});
return (function() {
var dcs$prototype_6$state$state_machine__25735__auto__ = null;
var dcs$prototype_6$state$state_machine__25735__auto____0 = (function (){
var statearr_27417 = [null,null,null,null,null,null,null,null];
(statearr_27417[(0)] = dcs$prototype_6$state$state_machine__25735__auto__);

(statearr_27417[(1)] = (1));

return statearr_27417;
});
var dcs$prototype_6$state$state_machine__25735__auto____1 = (function (state_27414){
while(true){
var ret_value__25736__auto__ = (function (){try{while(true){
var result__25737__auto__ = switch__25734__auto__(state_27414);
if(cljs.core.keyword_identical_QMARK_(result__25737__auto__,new cljs.core.Keyword(null,"recur","recur",-437573268))){
continue;
} else {
return result__25737__auto__;
}
break;
}
}catch (e27418){var ex__25738__auto__ = e27418;
var statearr_27419_27495 = state_27414;
(statearr_27419_27495[(2)] = ex__25738__auto__);


if(cljs.core.seq((state_27414[(4)]))){
var statearr_27420_27496 = state_27414;
(statearr_27420_27496[(1)] = cljs.core.first((state_27414[(4)])));

} else {
throw ex__25738__auto__;
}

return new cljs.core.Keyword(null,"recur","recur",-437573268);
}})();
if(cljs.core.keyword_identical_QMARK_(ret_value__25736__auto__,new cljs.core.Keyword(null,"recur","recur",-437573268))){
var G__27497 = state_27414;
state_27414 = G__27497;
continue;
} else {
return ret_value__25736__auto__;
}
break;
}
});
dcs$prototype_6$state$state_machine__25735__auto__ = function(state_27414){
switch(arguments.length){
case 0:
return dcs$prototype_6$state$state_machine__25735__auto____0.call(this);
case 1:
return dcs$prototype_6$state$state_machine__25735__auto____1.call(this,state_27414);
}
throw(new Error('Invalid arity: ' + arguments.length));
};
dcs$prototype_6$state$state_machine__25735__auto__.cljs$core$IFn$_invoke$arity$0 = dcs$prototype_6$state$state_machine__25735__auto____0;
dcs$prototype_6$state$state_machine__25735__auto__.cljs$core$IFn$_invoke$arity$1 = dcs$prototype_6$state$state_machine__25735__auto____1;
return dcs$prototype_6$state$state_machine__25735__auto__;
})()
})();
var state__25759__auto__ = (function (){var statearr_27421 = f__25758__auto__();
(statearr_27421[(6)] = c__25757__auto___27494);

return statearr_27421;
})();
return cljs.core.async.impl.ioc_helpers.run_state_machine_wrapped(state__25759__auto__);
}));

console.log("load waste-site");
var c__25757__auto___27498 = cljs.core.async.chan.cljs$core$IFn$_invoke$arity$1((1));
cljs.core.async.impl.dispatch.run((function (){
var f__25758__auto__ = (function (){var switch__25734__auto__ = (function (state_27432){
var state_val_27433 = (state_27432[(1)]);
if((state_val_27433 === (1))){
var inst_27422 = cljs_http.client.get("waste-site.json");
var state_27432__$1 = state_27432;
return cljs.core.async.impl.ioc_helpers.take_BANG_(state_27432__$1,(2),inst_27422);
} else {
if((state_val_27433 === (2))){
var inst_27424 = (state_27432[(2)]);
var inst_27425 = new cljs.core.Keyword(null,"status","status",-1997798413).cljs$core$IFn$_invoke$arity$1(inst_27424);
var inst_27426 = new cljs.core.Keyword(null,"success","success",1890645906).cljs$core$IFn$_invoke$arity$1(inst_27424);
var inst_27427 = ["waste-site, status=",cljs.core.str.cljs$core$IFn$_invoke$arity$1(inst_27425),", success=",cljs.core.str.cljs$core$IFn$_invoke$arity$1(inst_27426)].join('');
var inst_27428 = console.log(inst_27427);
var inst_27429 = new cljs.core.Keyword(null,"body","body",-2049205669).cljs$core$IFn$_invoke$arity$1(inst_27424);
var inst_27430 = cljs.core.reset_BANG_(dcs.prototype_6.state.waste_site_holder,inst_27429);
var state_27432__$1 = (function (){var statearr_27434 = state_27432;
(statearr_27434[(7)] = inst_27428);

return statearr_27434;
})();
return cljs.core.async.impl.ioc_helpers.return_chan(state_27432__$1,inst_27430);
} else {
return null;
}
}
});
return (function() {
var dcs$prototype_6$state$state_machine__25735__auto__ = null;
var dcs$prototype_6$state$state_machine__25735__auto____0 = (function (){
var statearr_27435 = [null,null,null,null,null,null,null,null];
(statearr_27435[(0)] = dcs$prototype_6$state$state_machine__25735__auto__);

(statearr_27435[(1)] = (1));

return statearr_27435;
});
var dcs$prototype_6$state$state_machine__25735__auto____1 = (function (state_27432){
while(true){
var ret_value__25736__auto__ = (function (){try{while(true){
var result__25737__auto__ = switch__25734__auto__(state_27432);
if(cljs.core.keyword_identical_QMARK_(result__25737__auto__,new cljs.core.Keyword(null,"recur","recur",-437573268))){
continue;
} else {
return result__25737__auto__;
}
break;
}
}catch (e27436){var ex__25738__auto__ = e27436;
var statearr_27437_27499 = state_27432;
(statearr_27437_27499[(2)] = ex__25738__auto__);


if(cljs.core.seq((state_27432[(4)]))){
var statearr_27438_27500 = state_27432;
(statearr_27438_27500[(1)] = cljs.core.first((state_27432[(4)])));

} else {
throw ex__25738__auto__;
}

return new cljs.core.Keyword(null,"recur","recur",-437573268);
}})();
if(cljs.core.keyword_identical_QMARK_(ret_value__25736__auto__,new cljs.core.Keyword(null,"recur","recur",-437573268))){
var G__27501 = state_27432;
state_27432 = G__27501;
continue;
} else {
return ret_value__25736__auto__;
}
break;
}
});
dcs$prototype_6$state$state_machine__25735__auto__ = function(state_27432){
switch(arguments.length){
case 0:
return dcs$prototype_6$state$state_machine__25735__auto____0.call(this);
case 1:
return dcs$prototype_6$state$state_machine__25735__auto____1.call(this,state_27432);
}
throw(new Error('Invalid arity: ' + arguments.length));
};
dcs$prototype_6$state$state_machine__25735__auto__.cljs$core$IFn$_invoke$arity$0 = dcs$prototype_6$state$state_machine__25735__auto____0;
dcs$prototype_6$state$state_machine__25735__auto__.cljs$core$IFn$_invoke$arity$1 = dcs$prototype_6$state$state_machine__25735__auto____1;
return dcs$prototype_6$state$state_machine__25735__auto__;
})()
})();
var state__25759__auto__ = (function (){var statearr_27439 = f__25758__auto__();
(statearr_27439[(6)] = c__25757__auto___27498);

return statearr_27439;
})();
return cljs.core.async.impl.ioc_helpers.run_state_machine_wrapped(state__25759__auto__);
}));

dcs.prototype_6.state.trend = (function dcs$prototype_6$state$trend(xy_pairs){
var rf = kixi.stats.core.simple_linear_regression(cljs.core.first,cljs.core.second);
var jsobj = cljs.core.transduce.cljs$core$IFn$_invoke$arity$3(cljs.core.identity,rf,xy_pairs);
return jsobj.slope;
});
dcs.prototype_6.state.maybe_calc_household_waste_derivations = (function dcs$prototype_6$state$maybe_calc_household_waste_derivations(){
var household_waste = cljs.core.deref(dcs.prototype_6.state.household_waste_holder);
var population = cljs.core.deref(dcs.prototype_6.state.population_holder);
if((((!((household_waste == null)))) && ((!((population == null)))))){
console.log("calculating household-waste-derivations");

var household_waste_derivation_generation0 = dcs.prototype_6.data_shaping.rollup_household_waste_materials_and_management(household_waste);
var household_waste_derivation_management0 = dcs.prototype_6.data_shaping.rollup_household_waste_materials(household_waste);
var household_waste_derivation_composition0 = dcs.prototype_6.data_shaping.rollup_household_waste_managements(household_waste);
var population_for_lookup = cljs.core.group_by(cljs.core.juxt.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"region","region",270415120),new cljs.core.Keyword(null,"year","year",335913393)),population);
var lookup_population = (function (region,year){
return new cljs.core.Keyword(null,"population","population",-1209901867).cljs$core$IFn$_invoke$arity$1(cljs.core.first(cljs.core.get.cljs$core$IFn$_invoke$arity$2(population_for_lookup,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [region,year], null))));
});
var household_waste_derivation_generation = cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p__27447){
var map__27448 = p__27447;
var map__27448__$1 = (((((!((map__27448 == null))))?(((((map__27448.cljs$lang$protocol_mask$partition0$ & (64))) || ((cljs.core.PROTOCOL_SENTINEL === map__27448.cljs$core$ISeq$))))?true:false):false))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__27448):map__27448);
var region = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__27448__$1,new cljs.core.Keyword(null,"region","region",270415120));
var year = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__27448__$1,new cljs.core.Keyword(null,"year","year",335913393));
var tonnes = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__27448__$1,new cljs.core.Keyword(null,"tonnes","tonnes",-913468653));
return new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"region","region",270415120),region,new cljs.core.Keyword(null,"year","year",335913393),year,new cljs.core.Keyword(null,"tonnes","tonnes",-913468653),(tonnes / lookup_population(region,year))], null);
}),household_waste_derivation_generation0);
var household_waste_derivation_management = cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p__27450){
var map__27451 = p__27450;
var map__27451__$1 = (((((!((map__27451 == null))))?(((((map__27451.cljs$lang$protocol_mask$partition0$ & (64))) || ((cljs.core.PROTOCOL_SENTINEL === map__27451.cljs$core$ISeq$))))?true:false):false))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__27451):map__27451);
var region = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__27451__$1,new cljs.core.Keyword(null,"region","region",270415120));
var year = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__27451__$1,new cljs.core.Keyword(null,"year","year",335913393));
var management = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__27451__$1,new cljs.core.Keyword(null,"management","management",-516161795));
var tonnes = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__27451__$1,new cljs.core.Keyword(null,"tonnes","tonnes",-913468653));
return new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"region","region",270415120),region,new cljs.core.Keyword(null,"year","year",335913393),year,new cljs.core.Keyword(null,"management","management",-516161795),management,new cljs.core.Keyword(null,"tonnes","tonnes",-913468653),(tonnes / lookup_population(region,year))], null);
}),household_waste_derivation_management0);
var household_waste_derivation_composition = cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p__27453){
var map__27454 = p__27453;
var map__27454__$1 = (((((!((map__27454 == null))))?(((((map__27454.cljs$lang$protocol_mask$partition0$ & (64))) || ((cljs.core.PROTOCOL_SENTINEL === map__27454.cljs$core$ISeq$))))?true:false):false))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__27454):map__27454);
var region = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__27454__$1,new cljs.core.Keyword(null,"region","region",270415120));
var year = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__27454__$1,new cljs.core.Keyword(null,"year","year",335913393));
var material = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__27454__$1,new cljs.core.Keyword(null,"material","material",460118677));
var tonnes = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__27454__$1,new cljs.core.Keyword(null,"tonnes","tonnes",-913468653));
return new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"region","region",270415120),region,new cljs.core.Keyword(null,"year","year",335913393),year,new cljs.core.Keyword(null,"material","material",460118677),material,new cljs.core.Keyword(null,"tonnes","tonnes",-913468653),(tonnes / lookup_population(region,year))], null);
}),household_waste_derivation_composition0);
var household_waste_derivation_percent_recycled = dcs.prototype_6.data_shaping.calc_household_waste_percentage_recycled(household_waste);
var latest_year = cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.max,cljs.core.map.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"year","year",335913393),household_waste));
var household_waste_derivation_generation_positions = new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"latest-positions","latest-positions",1854267729),cljs.core.map_indexed.cljs$core$IFn$_invoke$arity$2((function (ix,m){
return new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"region","region",270415120),new cljs.core.Keyword(null,"region","region",270415120).cljs$core$IFn$_invoke$arity$1(m),new cljs.core.Keyword(null,"position","position",-2011731912),(ix + (1)),new cljs.core.Keyword(null,"year","year",335913393),latest_year], null);
}),cljs.core.sort_by.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"tonnes","tonnes",-913468653),cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (p1__27441_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(latest_year,new cljs.core.Keyword(null,"year","year",335913393).cljs$core$IFn$_invoke$arity$1(p1__27441_SHARP_));
}),cljs.core.remove.cljs$core$IFn$_invoke$arity$2((function (p1__27440_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2("Scotland",new cljs.core.Keyword(null,"region","region",270415120).cljs$core$IFn$_invoke$arity$1(p1__27440_SHARP_));
}),household_waste_derivation_generation)))),new cljs.core.Keyword(null,"trend-positions","trend-positions",254538292),cljs.core.map_indexed.cljs$core$IFn$_invoke$arity$2((function (ix,m){
return new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"region","region",270415120),new cljs.core.Keyword(null,"region","region",270415120).cljs$core$IFn$_invoke$arity$1(m),new cljs.core.Keyword(null,"position","position",-2011731912),(ix + (1)),new cljs.core.Keyword(null,"trend","trend",54563841),new cljs.core.Keyword(null,"trend","trend",54563841).cljs$core$IFn$_invoke$arity$1(dcs.prototype_6.state.trend)], null);
}),cljs.core.sort_by.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"trend","trend",54563841),cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p__27456){
var vec__27457 = p__27456;
var region = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__27457,(0),null);
var coll = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__27457,(1),null);
return new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"region","region",270415120),region,new cljs.core.Keyword(null,"trend","trend",54563841),dcs.prototype_6.state.trend(cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p1__27443_SHARP_){
return (new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,"year","year",335913393).cljs$core$IFn$_invoke$arity$1(p1__27443_SHARP_),new cljs.core.Keyword(null,"tonnes","tonnes",-913468653).cljs$core$IFn$_invoke$arity$1(p1__27443_SHARP_)],null));
}),coll))], null);
}),cljs.core.group_by(new cljs.core.Keyword(null,"region","region",270415120),cljs.core.remove.cljs$core$IFn$_invoke$arity$2((function (p1__27442_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2("Scotland",new cljs.core.Keyword(null,"region","region",270415120).cljs$core$IFn$_invoke$arity$1(p1__27442_SHARP_));
}),household_waste_derivation_generation)))))], null);
var household_waste_derivation_percent_recycled_positions = new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"latest-positions","latest-positions",1854267729),cljs.core.map_indexed.cljs$core$IFn$_invoke$arity$2((function (ix,m){
return new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"region","region",270415120),new cljs.core.Keyword(null,"region","region",270415120).cljs$core$IFn$_invoke$arity$1(m),new cljs.core.Keyword(null,"position","position",-2011731912),(ix + (1)),new cljs.core.Keyword(null,"year","year",335913393),latest_year], null);
}),cljs.core.reverse(cljs.core.sort_by.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"tonnes","tonnes",-913468653),cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (p1__27445_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(latest_year,new cljs.core.Keyword(null,"year","year",335913393).cljs$core$IFn$_invoke$arity$1(p1__27445_SHARP_));
}),cljs.core.remove.cljs$core$IFn$_invoke$arity$2((function (p1__27444_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2("Scotland",new cljs.core.Keyword(null,"region","region",270415120).cljs$core$IFn$_invoke$arity$1(p1__27444_SHARP_));
}),household_waste_derivation_percent_recycled))))),new cljs.core.Keyword(null,"trend-positions","trend-positions",254538292),cljs.core.map_indexed.cljs$core$IFn$_invoke$arity$2((function (ix,m){
return new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"region","region",270415120),new cljs.core.Keyword(null,"region","region",270415120).cljs$core$IFn$_invoke$arity$1(m),new cljs.core.Keyword(null,"position","position",-2011731912),(ix + (1)),new cljs.core.Keyword(null,"trend","trend",54563841),new cljs.core.Keyword(null,"trend","trend",54563841).cljs$core$IFn$_invoke$arity$1(dcs.prototype_6.state.trend)], null);
}),cljs.core.reverse(cljs.core.sort_by.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"trend","trend",54563841),cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p__27460){
var vec__27461 = p__27460;
var region = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__27461,(0),null);
var coll = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__27461,(1),null);
return new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"region","region",270415120),region,new cljs.core.Keyword(null,"trend","trend",54563841),dcs.prototype_6.state.trend(cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p1__27446_SHARP_){
return (new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,"year","year",335913393).cljs$core$IFn$_invoke$arity$1(p1__27446_SHARP_),new cljs.core.Keyword(null,"percentage","percentage",-1610213650).cljs$core$IFn$_invoke$arity$1(p1__27446_SHARP_)],null));
}),coll))], null);
}),cljs.core.group_by(new cljs.core.Keyword(null,"region","region",270415120),household_waste_derivation_percent_recycled)))))], null);
cljs.core.reset_BANG_(dcs.prototype_6.state.household_waste_derivation_generation_holder,household_waste_derivation_generation);

cljs.core.reset_BANG_(dcs.prototype_6.state.household_waste_derivation_percent_recycled_holder,household_waste_derivation_percent_recycled);

cljs.core.reset_BANG_(dcs.prototype_6.state.household_waste_derivation_management_holder,household_waste_derivation_management);

cljs.core.reset_BANG_(dcs.prototype_6.state.household_waste_derivation_composition_holder,household_waste_derivation_composition);

cljs.core.reset_BANG_(dcs.prototype_6.state.household_waste_derivation_generation_positions_holder,household_waste_derivation_generation_positions);

return cljs.core.reset_BANG_(dcs.prototype_6.state.household_waste_derivation_percent_recycled_positions_holder,household_waste_derivation_percent_recycled_positions);
} else {
return null;
}
});
dcs.prototype_6.state.maybe_calc_household_co2e_derivations = (function dcs$prototype_6$state$maybe_calc_household_co2e_derivations(){
var household_co2e = cljs.core.deref(dcs.prototype_6.state.household_co2e_holder);
var population = cljs.core.deref(dcs.prototype_6.state.population_holder);
if((((!((household_co2e == null)))) && ((!((population == null)))))){
console.log("calculating household-co2e-derivations");

var population_for_lookup = cljs.core.group_by(cljs.core.juxt.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"region","region",270415120),new cljs.core.Keyword(null,"year","year",335913393)),population);
var lookup_population = (function (region,year){
return new cljs.core.Keyword(null,"population","population",-1209901867).cljs$core$IFn$_invoke$arity$1(cljs.core.first(cljs.core.get.cljs$core$IFn$_invoke$arity$2(population_for_lookup,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [region,year], null))));
});
var household_co2e_derivation_generation = cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p__27468){
var map__27469 = p__27468;
var map__27469__$1 = (((((!((map__27469 == null))))?(((((map__27469.cljs$lang$protocol_mask$partition0$ & (64))) || ((cljs.core.PROTOCOL_SENTINEL === map__27469.cljs$core$ISeq$))))?true:false):false))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__27469):map__27469);
var region = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__27469__$1,new cljs.core.Keyword(null,"region","region",270415120));
var year = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__27469__$1,new cljs.core.Keyword(null,"year","year",335913393));
var tonnes = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__27469__$1,new cljs.core.Keyword(null,"tonnes","tonnes",-913468653));
return new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"region","region",270415120),region,new cljs.core.Keyword(null,"year","year",335913393),year,new cljs.core.Keyword(null,"tonnes","tonnes",-913468653),(tonnes / lookup_population(region,year))], null);
}),household_co2e);
var latest_year = cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.max,cljs.core.map.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"year","year",335913393),household_co2e));
var household_co2e_derivation_generation_positions = new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"latest-positions","latest-positions",1854267729),cljs.core.map_indexed.cljs$core$IFn$_invoke$arity$2((function (ix,m){
return new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"region","region",270415120),new cljs.core.Keyword(null,"region","region",270415120).cljs$core$IFn$_invoke$arity$1(m),new cljs.core.Keyword(null,"position","position",-2011731912),(ix + (1)),new cljs.core.Keyword(null,"year","year",335913393),latest_year], null);
}),cljs.core.sort_by.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"tonnes","tonnes",-913468653),cljs.core.filter.cljs$core$IFn$_invoke$arity$2((function (p1__27465_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(latest_year,new cljs.core.Keyword(null,"year","year",335913393).cljs$core$IFn$_invoke$arity$1(p1__27465_SHARP_));
}),cljs.core.remove.cljs$core$IFn$_invoke$arity$2((function (p1__27464_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2("Scotland",new cljs.core.Keyword(null,"region","region",270415120).cljs$core$IFn$_invoke$arity$1(p1__27464_SHARP_));
}),household_co2e_derivation_generation)))),new cljs.core.Keyword(null,"trend-positions","trend-positions",254538292),cljs.core.map_indexed.cljs$core$IFn$_invoke$arity$2((function (ix,m){
return new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"region","region",270415120),new cljs.core.Keyword(null,"region","region",270415120).cljs$core$IFn$_invoke$arity$1(m),new cljs.core.Keyword(null,"position","position",-2011731912),(ix + (1)),new cljs.core.Keyword(null,"trend","trend",54563841),new cljs.core.Keyword(null,"trend","trend",54563841).cljs$core$IFn$_invoke$arity$1(dcs.prototype_6.state.trend)], null);
}),cljs.core.sort_by.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"trend","trend",54563841),cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p__27471){
var vec__27472 = p__27471;
var region = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__27472,(0),null);
var coll = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__27472,(1),null);
return new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"region","region",270415120),region,new cljs.core.Keyword(null,"trend","trend",54563841),dcs.prototype_6.state.trend(cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p1__27467_SHARP_){
return (new cljs.core.PersistentVector(null,2,(5),cljs.core.PersistentVector.EMPTY_NODE,[new cljs.core.Keyword(null,"year","year",335913393).cljs$core$IFn$_invoke$arity$1(p1__27467_SHARP_),new cljs.core.Keyword(null,"tonnes","tonnes",-913468653).cljs$core$IFn$_invoke$arity$1(p1__27467_SHARP_)],null));
}),coll))], null);
}),cljs.core.group_by(new cljs.core.Keyword(null,"region","region",270415120),cljs.core.remove.cljs$core$IFn$_invoke$arity$2((function (p1__27466_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2("Scotland",new cljs.core.Keyword(null,"region","region",270415120).cljs$core$IFn$_invoke$arity$1(p1__27466_SHARP_));
}),household_co2e_derivation_generation)))))], null);
cljs.core.reset_BANG_(dcs.prototype_6.state.household_co2e_derivation_generation_holder,household_co2e_derivation_generation);

return cljs.core.reset_BANG_(dcs.prototype_6.state.household_co2e_derivation_generation_positions_holder,household_co2e_derivation_generation_positions);
} else {
return null;
}
});
dcs.prototype_6.state.maybe_calc_business_waste_by_region_derivations = (function dcs$prototype_6$state$maybe_calc_business_waste_by_region_derivations(){
var business_waste_by_region = cljs.core.deref(dcs.prototype_6.state.business_waste_by_region_holder);
if((!((business_waste_by_region == null)))){
} else {
}

console.log("calculating business-waste-by-region-derivations");

var region_count = cljs.core.count(cljs.core.distinct.cljs$core$IFn$_invoke$arity$1(cljs.core.map.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"region","region",270415120),business_waste_by_region)));
var business_waste_by_region_derivation_generation0 = dcs.prototype_6.data_shaping.rollup_business_waste_by_region_materials(business_waste_by_region);
var business_waste_by_region_derivation_generation = cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p__27475){
var map__27476 = p__27475;
var map__27476__$1 = (((((!((map__27476 == null))))?(((((map__27476.cljs$lang$protocol_mask$partition0$ & (64))) || ((cljs.core.PROTOCOL_SENTINEL === map__27476.cljs$core$ISeq$))))?true:false):false))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__27476):map__27476);
var original = map__27476__$1;
var region = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__27476__$1,new cljs.core.Keyword(null,"region","region",270415120));
var year = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__27476__$1,new cljs.core.Keyword(null,"year","year",335913393));
var tonnes = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__27476__$1,new cljs.core.Keyword(null,"tonnes","tonnes",-913468653));
if(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2("Scotland",region)){
return new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"region","region",270415120),"Scotland average",new cljs.core.Keyword(null,"year","year",335913393),year,new cljs.core.Keyword(null,"tonnes","tonnes",-913468653),(tonnes / region_count)], null);
} else {
return original;
}
}),business_waste_by_region_derivation_generation0);
var business_waste_by_region_derivation_composition = business_waste_by_region;
cljs.core.reset_BANG_(dcs.prototype_6.state.business_waste_by_region_derivation_generation_holder,business_waste_by_region_derivation_generation);

return cljs.core.reset_BANG_(dcs.prototype_6.state.business_waste_by_region_derivation_composition_holder,business_waste_by_region_derivation_composition);
});
dcs.prototype_6.state.maybe_calc_waste_site_derivations = (function dcs$prototype_6$state$maybe_calc_waste_site_derivations(){
var waste_site = cljs.core.deref(dcs.prototype_6.state.waste_site_holder);
if((!((waste_site == null)))){
} else {
}

console.log("calculating waste-site-derivations");

var waste_site_derivation = dcs.prototype_6.data_shaping.count_waste_sites_per_category_per_region(waste_site);
return cljs.core.reset_BANG_(dcs.prototype_6.state.waste_site_derivation_holder,waste_site_derivation);
});
cljs.core.add_watch(dcs.prototype_6.state.population_holder,new cljs.core.Keyword(null,"household-waste-derivations-dependency","household-waste-derivations-dependency",1237970348),(function (_key,_atom,old_state,new_state){
if(cljs.core.truth_(new_state)){
return dcs.prototype_6.state.maybe_calc_household_waste_derivations();
} else {
return null;
}
}));
cljs.core.add_watch(dcs.prototype_6.state.population_holder,new cljs.core.Keyword(null,"household-co2e-derivations-dependency","household-co2e-derivations-dependency",-155623698),(function (_key,_atom,old_state,new_state){
if(cljs.core.truth_(new_state)){
return dcs.prototype_6.state.maybe_calc_household_co2e_derivations();
} else {
return null;
}
}));
cljs.core.add_watch(dcs.prototype_6.state.household_waste_holder,new cljs.core.Keyword(null,"household-waste-derivations-dependency","household-waste-derivations-dependency",1237970348),(function (_key,_atom,old_state,new_state){
if(cljs.core.truth_(new_state)){
return dcs.prototype_6.state.maybe_calc_household_waste_derivations();
} else {
return null;
}
}));
cljs.core.add_watch(dcs.prototype_6.state.household_co2e_holder,new cljs.core.Keyword(null,"household-co2e-derivations-dependency","household-co2e-derivations-dependency",-155623698),(function (_key,_atom,old_state,new_state){
if(cljs.core.truth_(new_state)){
return dcs.prototype_6.state.maybe_calc_household_co2e_derivations();
} else {
return null;
}
}));
cljs.core.add_watch(dcs.prototype_6.state.business_waste_by_region_holder,new cljs.core.Keyword(null,"business-waste-by-region-derivations-dependency","business-waste-by-region-derivations-dependency",869918158),(function (_key,_atom,old_state,new_state){
if(cljs.core.truth_(new_state)){
return dcs.prototype_6.state.maybe_calc_business_waste_by_region_derivations();
} else {
return null;
}
}));
cljs.core.add_watch(dcs.prototype_6.state.waste_site_holder,new cljs.core.Keyword(null,"waste-site-derivations-dependency","waste-site-derivations-dependency",-357300318),(function (_key,_atom,old_state,new_state){
if(cljs.core.truth_(new_state)){
return dcs.prototype_6.state.maybe_calc_waste_site_derivations();
} else {
return null;
}
}));

//# sourceMappingURL=dcs.prototype_6.state.js.map
