{"version":3,"sources":["dcs/prototype_6/view/household_waste_analysis/detail.cljs"],"mappings":";AAQA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAKA;AAEL,AAAA,AAAMC,AACCC;AADP,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAK4BA,AAIMF;;AAqClC,AAAA,AAAMG,AAAQC;AAAd,AACM,AAAMF,AAAWE;AAAjB,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAQUC,AAAa,AAACJ,AAAWC,AACzBI;;AAahB,AAAA,AAAME;AAAN,AAAA,AAAA,AAAAD,AACOJ,AACCM","names":["dcs.prototype-6.view.household-waste-analysis.detail/stratum-labels","dcs.prototype-6.view.household-waste-analysis.detail/chart-spec","chart-data","dcs.prototype-6.view.household-waste-analysis.detail/charts","derivation","oz.core/vega-lite","dcs.prototype-6.util/vega-embed-opts","cljs.core/deref","dcs.prototype-6.view.household-waste-analysis.detail/root","dcs.prototype-6.state/household-waste-analysis-derivation-cursor"],"sourcesContent":["(ns dcs.prototype-6.view.household-waste-analysis.detail\n  (:require\n    [reagent.core :as r]\n    [oz.core :as oz]\n    [goog.string :as gstring]\n    [dcs.prototype-6.util :as util]\n    [dcs.prototype-6.state :as state]))\n\n(def stratum-labels [\"urban \u00a3\" \"urban \u00a3\u00a3\" \"urban \u00a3\u00a3\u00a3\" \"rural \u00a3/\u00a3\u00a3\" \"rural \u00a3\u00a3\u00a3\"])\n\n(defn chart-spec\n      [chart-data]\n      {:schema     \"https://vega.github.io/schema/vega/v5.json\"\n       :background \"floralwhite\"\n       :spacing 3\n       :data       {:values chart-data}\n       :transform  [{:aggregate [{:op \"mean\" :field \"kgPerHhPerWk\" :as \"kg\"}]\n                     :groupby [\"stratum\" \"material-L1\" \"material-L2\" \"stream\" \"idealStream\"]}]\n       :facet     {:column {:field \"stratum\" :type \"nominal\"\n                            :sort stratum-labels\n                            :header {:title \"household type (location type & council tax band)\"}}\n                   :row {:field \"material-L2\" :type \"nominal\"\n                         :header {:title \"material (in detail)\" :labelAngle 0 :labelAlign \"left\"}\n                         :sort {:field \"kg\" :op \"max\" :order \"descending\"}}}\n       :spec {:width 130\n              :height 20\n              :layer [{:mark \"bar\"\n                       :encoding {:x {:field \"kg\" :type \"quantitative\" :scale {:type \"sqrt\"} :axis {:title \"avg kg/hh/wk\"}}\n                                  :y {:field \"stream\" :type \"nominal\" :axis {:title \"\"}}\n                                  :color {:field \"material-L2\" :type \"nominal\"\n                                          :scale {:scheme \"tableau20\"}\n                                          :legend nil}\n                                  :fillOpacity {:value 0.5}\n                                  :tooltip [{:field \"stratum\" :type \"nominal\" :title \"house type (location & CTax)\"}\n                                            {:field \"material-L1\" :type \"nominal\" :title \"material (high level)\"}\n                                            {:field \"material-L2\" :type \"nominal\" :title \"material (in detail)\"}\n                                            {:field \"stream\" :type \"nominal\" :title \"(actual) disposal\"}\n                                            {:field \"idealStream\" :type \"nominal\" :title \"ideal disposal\"}\n                                            {:field \"kg\" :type \"quantitative\" :title \"kg per household per week\"}]}}\n                      {:mark \"bar\"\n                       :transform [{:filter \"(datum.kg > 0) && (datum.stream != datum.idealStream)\"}],\n                       :encoding {:x {:field \"kg\" :type \"quantitative\" :scale {:type \"sqrt\"} :axis {:title \"avg kg/hh/wk\"}}\n                                  :y {:field \"stream\" :type \"nominal\" :axis {:title \"\"}}\n                                  :color {:field \"material-L2\" :type \"nominal\"\n                                          :scale {:scheme \"tableau20\"}\n                                          :legend nil}\n                                  :fillOpacity {:value 0}\n                                  :stroke {:value \"red\"}\n                                  :strokeWidth {:value 1}\n                                  :tooltip [{:field \"stratum\" :type \"nominal\" :title \"house type (location & CTax)\"}\n                                            {:field \"material-L1\" :type \"nominal\" :title \"material (high level)\"}\n                                            {:field \"material-L2\" :type \"nominal\" :title \"material (detailed level)\"}\n                                            {:field \"stream\" :type \"nominal\" :title \"(actual) disposal\"}\n                                            {:field \"idealStream\" :type \"nominal\" :title \"ideal disposal\"}\n                                            {:field \"kg\" :type \"quantitative\" :title \"avg kg per household per wk\"}]}}]}})\n\n(defn charts [derivation]\n      (let [chart-data derivation]\n\n           [:div.tile.is-ancestor\n\n            [:div.tile.is-6\n             [:div.tile.is-vertical.is-parent\n\n              [:div.tile.is-child\n               [oz/vega-lite (chart-spec chart-data)\n                util/vega-embed-opts]]\n\n              [:div.tile.is-child.content\n               [:blockquote\n                [:p \"TODO:\"]\n                [:ul\n                 [:li \"This chart conveys a fair amount of information - explain how to interpret it. E.g. bars outlined in red represent inappropriate disposal.\"]\n                 [:li \"How should we interpret for 'Unavoidable food waste'? Was there an collection that targeted food & garden waste,\n                 that wasn't covered by the sample dataset? ...since that would might mean that, elsewhere,  'Unavoidable food waste' was being disposed of appropriately.\"]]]\n               ]\n\n              ]]]))\n\n(defn root []\n      [charts\n       @state/household-waste-analysis-derivation-cursor])\n"]}