{"version":3,"sources":["dcs/prototype_6/view/stirling_community_food/flow.cljs"],"mappings":";AAMA,AAAA,AAAMA,AAAcC;AAApB,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAsBkCA;;AAMlC,AAAA,AAAMC,AAAWC;AAAjB,AACM,AAAMF,AAAK,AAAA,AAAO,AAACG,AAAQD;AAA3B,AACE,AAAAE,AAAsB,AAACC,AAAcH,AAAM,AAACI,AAAQ,AAACP,AAAaC;;AAE1E,AAAA,AAAMO,AAAYL,AAAKM;AAAvB,AACM,AAACP,AAAUC;;AAEjB,AAAA,AAAMO;AAAN,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA;;AAIA,AAAA,AAAMC;AAAN,AACM,AAAA,AAAA,AAAA,AAAA,AAACC,AAAsCF,AACAR,AACAM;;AAE7C,AAAA,AAAMM;AAAN,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAD,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAQWF,AAAkBI","names":["dcs.prototype-6.view.stirling-community-food.flow/chart-config","flow","dcs.prototype-6.view.stirling-community-food.flow/did-mount","this","reagent.core/props","js/Highcharts.Chart","reagent.dom/dom-node","cljs.core/clj->js","dcs.prototype-6.view.stirling-community-food.flow/did-update","prev-props","dcs.prototype-6.view.stirling-community-food.flow/render","dcs.prototype-6.view.stirling-community-food.flow/component","reagent.core.create_class","cljs.core/deref","dcs.prototype-6.view.stirling-community-food.flow/root","dcs.prototype-6.state/stirling-community-food-tonnes-derivation-flow-cursor"],"sourcesContent":["(ns dcs.prototype-6.view.stirling-community-food.flow\n  (:require [reagent.core :as r]\n            [reagent.dom :as rdom]\n            [dcs.prototype-6.state :as state]\n    #_[dcs.prototype-6.view.stirling-community-food.map :as map]))\n\n(defn chart-config [flow]\n  {\n   :chart         {:backgroundColor \"#980f3d\"}\n   :navigation    {:buttonOptions {:enabled false}}\n   :title         nil                                       ;{:text \"The flow of food material\"}\n   :subtitle      nil                                       ;{:text \"subtitle does here\"}\n   :accessibility {:point {:valueDescriptionFormat \"{index}. {point.from} to {point.to}, {point.weight}.\"}}\n   :tooltip       {:headerFormat nil\n                   :pointFormat  \"{point.fromNode.name} \\u2192 {point.toNode.name}: {point.weight:.2f} tonnes\"\n                   :nodeFormat   \"{point.name}: {point.sum:.2f} tonnes\"}\n   ;:plotOptions {:sankey {:label { :minFontSize 4}}}\n   :series        [{:keys         [\"from\" \"to\" \"weight\"]\n                    :minLinkWidth 17\n                    :label        {:minFontSize 6}\n                    :nodes        [{:id \"Would-be waste\" :color \"red\"}\n                                   {:id \"Not waste\" :color \"#00C9A9\"}\n                                   {:id \"Stirling Community Food\" :color \"#B3AA99\"}\n                                   {:id \"Not wasted\" :color \"#00C9A9\"}\n                                   {:id \"Used as food\" :color \"#B6E6F6\"}\n                                   {:id \"Donated to animal scantuary\" :color \"#AC8E00\"}\n                                   {:id \"Used for compost\" :color \"#A16A51\"}\n                                   {:id \"Disposed of as waste\" :color \"red\" :level 4}]\n                    :data         flow\n                    :type         \"sankey\"\n                    :name         \"The flow of food material\"}]\n   :credits       {:enabled false}\n   })\n\n(defn did-mount [this]\n      (let [flow (:data (r/props this))]\n        (js/Highcharts.Chart. (rdom/dom-node this) (clj->js (chart-config flow)))))\n\n(defn did-update [this prev-props]\n      (did-mount this)) ;; TODO figure out a more surgical means to update the chart\n\n(defn render []\n      [:div {:style {:min-width \"310px\" :max-width \"820px\"\n                     :height    \"400px\" :margin \"0\"}}])\n\n(defn component []\n      (r/create-class {:reagent-render       render\n                       :component-did-mount  did-mount\n                       :component-did-update did-update}))\n\n(defn root []\n\n      [:div.tile.is-ancestor\n\n       [:div.tile\n        [:div.tile.is-vertical.is-parent\n\n         [:div.tile.is-child\n          [component {:data @state/stirling-community-food-tonnes-derivation-flow-cursor}]]\n         [:div.tile.is-child.has-text-primary-light.content\n          [:p \"Food materials flow left-to-right through Stirling Community Food's process.\"\n          \" On the left are the sources: supermarkets, collection aggregators, donors.\"\n           \" On the right are the outcomes, broadly: not wasted, or waste was unavoidable.\"\n           \" (Hover over a part to display the tonnes of food material flowing through that part of the process, during the year.)\"]]]]])\n\n"]}