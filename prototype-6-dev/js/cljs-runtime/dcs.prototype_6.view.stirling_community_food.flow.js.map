{"version":3,"sources":["dcs/prototype_6/view/stirling_community_food/flow.cljs"],"mappings":";AAMA,AAAA,AAAMA,AAAcC,AAAKC;AAAzB,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAqCkCD;;AAMlC,AAAA,AAAME,AAAWC;AAAjB,AACM,AAAMH,AAAK,AAAA,AAAO,AAACI,AAAQD;AAA3B,AACE,AAAAE,AAAsB,AAACC,AAAcH,AAAM,AAACI,AAAQ,AAAA,AAACR,AAAaC;;AAE1E,AAAA,AAAMQ,AAAYL,AAAKM;AAAvB,AACM,AAACP,AAAUC;;AAEjB,AAAA,AAAMO;AAAN,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA;;AAIA,AAAA,AAAMC;AAAN,AACM,AAAA,AAAA,AAAA,AAAA,AAACC,AAAsCF,AACAR,AACAM;;AAE7C,AAAA,AAAMM;AAAN,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAD,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAQWF,AAAkBI","names":["dcs.prototype-6.view.stirling-community-food.flow/chart-config","flow","_title","dcs.prototype-6.view.stirling-community-food.flow/did-mount","this","reagent.core/props","js/Highcharts.Chart","reagent.dom/dom-node","cljs.core/clj->js","dcs.prototype-6.view.stirling-community-food.flow/did-update","_prev-props","dcs.prototype-6.view.stirling-community-food.flow/render","dcs.prototype-6.view.stirling-community-food.flow/component","reagent.core.create_class","cljs.core/deref","dcs.prototype-6.view.stirling-community-food.flow/root","dcs.prototype-6.state/stirling-community-food-tonnes-derivation-flow-cursor"],"sourcesContent":["(ns dcs.prototype-6.view.stirling-community-food.flow\n  (:require [reagent.core :as r]\n            [reagent.dom :as rdom]\n            [dcs.prototype-6.state :as state]\n    #_[dcs.prototype-6.view.stirling-community-food.map :as map]))\n\n(defn chart-config [flow _title]\n  {\n   :chart         {:backgroundColor \"#980f3d\"}\n   :navigation    {:buttonOptions {:enabled false}}\n   :title         nil #_{:text _title \n                         :style {:color \"white\" \n                                 :fontSize \"12px\"}}\n   :subtitle      nil\n   :accessibility {:point {:valueDescriptionFormat \"{index}. {point.from} to {point.to}, {point.weight}.\"}}\n   :tooltip       {:headerFormat nil\n                   :pointFormat  \"{point.fromNode.name} \\u2192 {point.toNode.name}: {point.weight:.2f} tonnes\"\n                   :nodeFormat   \"{point.name}: {point.sum:.2f} tonnes\"}\n   :plotOptions {:sankey {\n                          ;:label { :minFontSize 4}\n                          :nodePadding 20\n                          :dataLabels {\n                          ;             :crop false\n                          ;             :overflow \"allow\"\n                                        :allowOverlap true}\n                          }}\n   :series        [{:keys         [\"from\" \"to\" \"weight\"]\n                    :minLinkWidth 6\n                    :label        {:minFontSize 6}\n                    :nodes        [{:id \"Purchased\" :color \"#FFC473\"}\n                                   {:id \"Donated not waste\" :color \"#7158A1\"}\n                                   {:id \"Donated as waste\" :color \"#BF5748\"}\n                                   {:id \"Other\" :color \"#928E85\"}\n                                   {:id \"Local supermarkets\" :color \"#006CAE\"}\n                                   {:id \"Fareshare\" :color \"#59896A\"}\n                                   {:id \"Would-be waste\" :color \"#EF0606\"}\n                                   {:id \"Not waste\" :color \"#00C9A9\"}\n                                   {:id \"Stirling Community Food\" :color \"#009790\"}\n                                   {:id \"Used as food\" :color \"#00AC8F\" :level 4 :offset -100}\n                                   {:id \"Not used as food\" :color \"#98B0A9\" :offset 105}\n                                   {:id \"Donated to animal sanctuary\" :color \"#006AC7\" :offset 280}\n                                   {:id \"Used by individuals for compost\" :color \"#B49531\" :offset 280}\n                                   {:id \"Council compost, Energen biogas, etc.\" :color \"#E27E44\" :offset 280}]\n                    :data         flow\n                    :type         \"sankey\"\n                    :name         \"The flow of food material\"}]\n   :credits       {:enabled false}\n   })\n\n(defn did-mount [this]\n      (let [flow (:data (r/props this))]\n        (js/Highcharts.Chart. (rdom/dom-node this) (clj->js (chart-config flow \"Graph 1: Flow of food materials\" )))))\n\n(defn did-update [this _prev-props]\n      (did-mount this)) ;; TODO figure out a more surgical means to update the chart\n\n(defn render []\n      [:div {:style {:min-width \"340px\" :max-width \"880px\"\n                     :height    \"400px\" :margin \"0\"}}])\n\n(defn component []\n      (r/create-class {:reagent-render       render\n                       :component-did-mount  did-mount\n                       :component-did-update did-update}))\n\n(defn root []\n\n      [:div.tile.is-ancestor\n\n       [:div.tile\n        [:div.tile.is-vertical.is-parent\n\n         [:div.tile.is-child\n          [component {:data @state/stirling-community-food-tonnes-derivation-flow-cursor}]]\n         [:div.tile.is-child.has-text-primary-light.content\n          [:p \"Food materials flow left-to-right through Stirling Community Food's process.\"\n          \" On the left are the sources: aggregations of supermarkets, collection agencies, and donors.\"\n           \" On the right are the outcomes, broadly: used as food, or not.\"\n           \" (Hover over a part to display the tonnes of food material flowing through that part of the process, during the year.)\"]\n          ]]]])\n"]}