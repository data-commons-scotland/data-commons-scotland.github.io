{"version":3,"sources":["dcs/prototype_6/view/regional_dashboard/household_waste_derivation_management.cljs"],"mappings":";AAOA,AAAA,AAAMA,AAAYC,AAAMC,AAAQC;AAAhC,AACM,AAAMC,AAAW,AAACC,AAAM,AAAA,AAACC,AAAeH;AAAxC,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAEkBF,AAISE,AAOoEC;;AAarG,AAAA,AAAMG,AAAOC,AAAOC;AAApB,AACM,AACMC,AAAuC,AAAA,AAAAC,AAACC;AAAD,AAAS,AAACC,AAAEL,AAAO,AAAA,AAAAG;AAAaF;AAGvEK,AAAwC,AAAA,AAAAC,AAACC;AAAD,AAAM,AAAAD,AAAA,AAACE,AAAc,AAAK,AAAA,AAAAF;AACrBL;AALnD,AAAA,AAAA,AAAA,AAOOQ,AAAa,AAAA,AAAClB,AAAwBQ,AAAOM,AAC7CK;;AAEb,AAAA,AAAME;AAAN,AAAA,AAAA,AAAAD,AAAA,AAAAA,AACOb,AAAOe,AAAqBC","names":["dcs.prototype-6.view.regional-dashboard.household-waste-derivation-management/chart-spec","title","_region","data","year-count","cljs.core/count","cljs.core/group-by","dcs.prototype-6.view.regional-dashboard.household-waste-derivation-management/chart","region","household-waste-derivation-management","household-waste-derivation-management'","p1__35007#","cljs.core.filter","cljs.core._EQ_","household-waste-derivation-management''","p1__35011#","cljs.core.map","cljs.core.assoc","oz.core/vega-lite","dcs.prototype-6.util/vega-embed-opts","cljs.core/deref","dcs.prototype-6.view.regional-dashboard.household-waste-derivation-management/root","dcs.prototype-6.state/region-cursor","dcs.prototype-6.state/household-waste-derivation-management-cursor"],"sourcesContent":["(ns dcs.prototype-6.view.regional-dashboard.household-waste-derivation-management\n  (:require\n    [oz.core :as oz]\n    [dcs.prototype-6.util :as util]\n    [dcs.prototype-6.state :as state]))\n\n\n(defn chart-spec [title _region data]\n      (let [year-count (count (group-by :year data))]\n           {:schema     \"https://vega.github.io/schema/vega/v5.json\"\n            :title      title\n            :width      200\n            :height     100\n            :background \"floralwhite\"\n            :data       {:values data}\n            :mark       {:type                 \"bar\"\n                         :cornerRadiusTopLeft  3\n                         :cornerRadiusTopRight 3}\n            :selection  {:my {:type   \"multi\"\n                              :fields [\"region\"]\n                              :bind   \"legend\"}}\n            :encoding   {:x       {:field \"year\" :type \"temporal\" :timeUnit \"year\" :axis {:tickCount year-count :title \"year\"}}\n                         :y       {:field \"tonnes\" :type \"quantitative\" :scale {:zero false} :axis {:title \"tonnes\"}}\n                         :color   {:field  \"management\"\n                                   :type   \"nominal\"\n                                   :scale  {:domain [\"Recycled\" \"Landfilled\" \"Other Diversion\"]\n                                            :range  [\"#bdbd8d\" \"#c49c49\" \"#c7c7c7\"]}\n                                   :legend nil}\n                         :opacity {:condition {:selection \"my\" :value 1}\n                                   :value     0.2}\n                         :tooltip [{:field \"management\" :type \"nominal\"}\n                                   {:field \"year\" :type \"temporal\"}\n                                   {:field \"tonnes\" :type \"quantitative\"}]}}))\n\n(defn chart [region household-waste-derivation-management]\n      (let [;; filter\n            household-waste-derivation-management' (filter #(= region (:region %)) household-waste-derivation-management)\n\n            ;; stringify the year for Vega\n            household-waste-derivation-management'' (map #(assoc % :year (str (:year %)))\n                                                         household-waste-derivation-management')]\n           [:div\n            [oz/vega-lite (chart-spec \"Management\" region household-waste-derivation-management'')\n             util/vega-embed-opts]]))\n\n(defn root []\n      [chart @state/region-cursor @state/household-waste-derivation-management-cursor])"]}