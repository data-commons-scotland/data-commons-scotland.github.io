{"version":3,"sources":["dcs/prototype_6/view/fairshare/per_quarter.cljs"],"mappings":";AAMA,AAAA,AAAMA,AACHC,AAAKC;AADR,AAEE,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAMC;AAAN,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAyBeD,AACSD,AAQRE;;AAGlB,AAAA,AAAMC,AAAQC;AAAd,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAGKC,AAAa,AAAA,AAACN,AAAsBK,AACpCE;;AAWL,AAAA,AAAME;AAAN,AAAA,AAAA,AAAAD,AACOJ,AACCM","names":["dcs.prototype-6.view.fairshare.per-quarter/chart-spec-per-season","data","title","layer-normal","dcs.prototype-6.view.fairshare.per-quarter/charts","material","oz.core/vega-lite","dcs.prototype-6.util/vega-embed-opts","cljs.core/deref","dcs.prototype-6.view.fairshare.per-quarter/root","dcs.prototype-6.state/fairshare-derivation-material-cursor"],"sourcesContent":["(ns dcs.prototype-6.view.fairshare.per-quarter\n  (:require\n   [oz.core :as oz]\n   [dcs.prototype-6.util :as util]\n   [dcs.prototype-6.state :as state]))\n\n(defn chart-spec-per-season\n  [data title]\n  (let [layer-normal      {:mark     {:type                 \"bar\"\n                                      :cornerRadiusTopLeft  3\n                                      :cornerRadiusTopRight 3}\n                           :encoding {:x       {:title \"year quarter\"\n                                                :field \"quarter\"\n                                                :type  \"temporal\"\n                                                :axis  {:labelExpr  \"timeFormat(datum.value, '%q') == '1' ? timeFormat(datum.value, 'Q%q %Y') : timeFormat(datum.value, 'Q%q')\"\n                                                        :labelAngle 90\n                                                        :tickCount  {:interval \"month\"\n                                                                     :step     3\n                                                                     :start    0}}}\n                                      :y       {:field \"tonnes\"\n                                                :type  \"quantitative\"}\n                                      :color   {:value \"#A2CAC1\"}\n                                      :tooltip [{:title  \"year quarter\"\n                                                 :field  \"quarter\"\n                                                 :type   \"temporal\"\n                                                 :format \"Q%q %Y\"}\n                                                {:field  \"tonnes\"\n                                                 :type   \"quantitative\"\n                                                 :format \".3f\"}]}}]\n    {:schema     \"https://vega.github.io/schema/vega/v5.json\"\n     :width      370\n     :height     200\n     :background \"#f2dfce\"\n     :title      title\n     :data       {:values data}\n     :transform  [{:timeUnit \"yearquarter\"\n                   :field    \"yyyy-MM-dd\"\n                   :as       \"quarter\"}\n                  {:aggregate [{:op    \"sum\"\n                                :field \"tonnes\"\n                                :as    \"tonnes\"}]\n                   :groupby   [\"quarter\"]}]\n     :layer      [layer-normal]}))\n\n\n(defn charts [material]\n  [:div.columns\n   [:column\n    [oz/vega-lite (chart-spec-per-season material \"Graph 4: Donations per quarter\")\n     util/vega-embed-opts]]\n   [:column\n    [:div.m-4.content\n     [:p \"Q3 donations are, by far, the most pronounced.\"\n      \" Q3 starts in June which - at Stirling, the host university - is the end of the academic year for most courses.\"\n      \" So the high Q3 donations are likely to be the results of students donating possessions before leaving for the summer.\"]\n     [:p \"For the period Q2 2013 to Q1 2014 the data has less date resolution which partially accounts for the irregular donation pattern during this period.\"\n      \" Another factor, Q1 2014 during this period, was the unusually large donation of textiles\"\n      \" (duvet covers, sheets, pillowcases) from the student halls of residence [also evident in Graph 1].\"]\n     [:p \"During the period Q1 2020 to Q2 2021 there were no donations because the store's normal operation was suspended due to Covid-19.\"]]]])\n\n(defn root []\n      [charts\n       @state/fairshare-derivation-material-cursor])"]}