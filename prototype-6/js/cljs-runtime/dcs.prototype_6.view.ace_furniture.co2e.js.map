{"version":3,"sources":["dcs/prototype_6/view/ace_furniture/co2e.cljs"],"mappings":"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","names":["dcs.prototype-6.view.ace-furniture.co2e/chart-spec-category-level","data","dcs.prototype-6.view.ace-furniture.co2e/chart-spec-item-level","dcs.prototype-6.view.ace-furniture.co2e/hint","dcs.prototype-6.view.ace-furniture.co2e/tabbed-area","flights-per-category","flights-per-item","e","dcs.prototype-6.util/open-tab","reitit.frontend.easy.href","oz.core/vega-lite","dcs.prototype-6.util/vega-embed-opts","cljs.core/deref","dcs.prototype-6.view.ace-furniture.co2e/root","dcs.prototype-6.state/ace-furniture-derivation-flights-per-category-cursor","dcs.prototype-6.state/ace-furniture-derivation-flights-per-item-cursor"],"sourcesContent":["(ns dcs.prototype-6.view.ace-furniture.co2e\n  (:require\n    [reitit.frontend.easy :as rfe]\n    [oz.core :as oz]\n    [dcs.prototype-6.util :as util]\n    [dcs.prototype-6.state :as state]))\n\n\n(defn chart-spec-category-level\n      [data]\n       {:schema     \"https://vega.github.io/schema/vega/v5.json\"\n        :width      500\n        :height     400\n        :background \"#f2dfce\"                                ;  \"#980f3d\"  \"#fff1e5\"\n        :data       {:values data}\n        :transform  [{:calculate \"datum.flight==1 ? '\u2708\ufe0f' : ''\" :as \"emoji\"}\n                     {:window  [{:op \"sum\" :field \"flight\" :as \"flights\"}]\n                      :groupby [\"category\"]}]\n        :mark       {:type  \"text\"\n                     :align \"left\"}\n        :encoding   {:y       {:field \"category\" :type \"nominal\"\n                               :sort {:field \"co2e\" :order \"descending\"}}\n                     :x       {:field \"flights\"\n                               :type  \"quantitative\"\n                               :axis  {:title \"equivalent number of flights\"}}\n                     :text    {:field \"emoji\" :type \"nominal\"}\n                     :size    {:value 15}\n                     :tooltip [{:field \"category\" :type \"nominal\"}\n                               {:title \"kg of CO2e\" :field \"co2e\" :type \"quantitative\"}\n                               {:title \"equivalent number of flights\" :field \"flights-total\" :type \"quantitative\"}]}\n        :config     {:axisX {:grid false}}})\n\n\n(defn chart-spec-item-level\n      [data]\n      {:schema     \"https://vega.github.io/schema/vega/v5.json\"\n       :width      500\n       :height     1500\n       :background \"#f2dfce\"                                ;  \"#980f3d\"  \"#fff1e5\"\n       :data       {:values data}\n       :transform  [{:calculate \"datum.flight==1 ? '\u2708\ufe0f' : ''\" :as \"emoji\"}\n                    {:window  [{:op \"sum\" :field \"flight\" :as \"flights\"}]\n                     :groupby [\"category\" \"item\"]}]\n       :mark       {:type  \"text\"\n                    :align \"left\"}\n       :encoding   {:y       {:field \"item\" :type \"nominal\"\n                              :sort {:field \"co2e\" :order \"descending\"}}\n                    :x       {:field \"flights\"\n                              :type  \"quantitative\"\n                              :axis  {:title \"equivalent number of flights\"}}\n                    :text    {:field \"emoji\" :type \"nominal\"}\n                    :size    {:value 15}\n                    :tooltip [{:field \"category\" :type \"nominal\"}\n                              {:field \"item\" :type \"nominal\"}\n                              {:title \"kg of CO2e\" :field \"co2e\" :type \"quantitative\"}\n                              {:title \"equivalent number of flights\" :field \"flights-total\" :type \"quantitative\"}]}\n       :config     {:axisX {:grid false}}})\n\n(def hint [:div.content.is-small.has-text-info-dark\n           [:p \"Click on a bar in the graph to see the item category, the exact CO2e amount and flights count.\"]])\n\n(defn tabbed-area \n  [flights-per-category flights-per-item]\n  [:div\n   [:div.tabs\n    [:ul\n     [:li.tab-co2e-since-inception.is-active {:on-click (fn [e] (util/open-tab e \"co2e-since-inception\" \"category-level\"))} [:a \"Less detail\"]]\n     [:li.tab-co2e-since-inception {:on-click (fn [e] (util/open-tab e \"co2e-since-inception\" \"item-level\"))} [:a \"More detail\"]]]]\n\n   [:div#category-level-co2e-since-inception.content.tab-content-co2e-since-inception\n    [:p \"The \" [:b \"total CO\" [:sub \"2\"] \"e\"] \" (in terms of flights) of the items of furniture sold (Mar 2017-Aug 2019) in each \" [:b \"category\"] \".\"]\n    [:p \"Each item reused through the ACE initative, is an item that has avoided becoming waste/pollution.\"\n      \" Pollution is often estimated in terms of CO\" [:sub \"2\"] \"e,\"\n      \" and we can estimate this for ACE by multipling the total weight of the items\"\n      \" in each category (as shown in the section above) by an appropriate \" [:em \"multiplier\"] \".\"\n      \" These multipliers can be found in \" \n      [:a {:href (rfe/href :dcs.prototype-6.router/data-view nil {:target \"co2e-multiplier\"})} \"The Scottish Carbon Metric multiplier table\"] \".\"\n      \" Also, we have to \" [:em \"map\"] \" ACE's item categories to records in that table,\"\n      \" and this is done via \" [:a {:href (rfe/href :dcs.prototype-6.router/data-view nil {:target \"ace-furniture-to-scottishCarbonMetric\"})} \"this mapping table\"] \".\"]\n     [:p \" But by themselves, CO\" [:sub \"2\"] \"e values can be difficult to relate to so\"\n      \" we convert them into in a more relatable measure: \" [:em \"flights worth\"] \" of CO\" [:sub \"2\"] \"e...\"\n      \" The average cost of taking a one-way flight from Glasgow to Berlin is 202.5 kgs of CO\" [:sub \"2\"] \"e.\"\n      \" (This was derived from \" \n      [:a {:href \"https://www.ovoenergy.com/ovo-newsroom/press-releases/2019/november/think-before-you-thank-if-every-brit-sent-one-less-thank-you-email-a-day-we-would-save-16433-tonnes-of-carbon-a-year-the-same-as-81152-flights-to-madrid.html\"\n           :target \"_blank\"} \"these OVO Energy estimations\"]\n      \" which incorporate a plane's fuel use but not its build material.)\"\n      \" We divide ACE's CO\" [:sub \"2\"] \"e values by 202.5 to yield our \" [:em \"flights worth\"] \" of CO\" [:sub \"2\"] \"e values\"\n      \" then use these to plot this graph.\"]\n    hint\n    [oz/vega-lite (chart-spec-category-level flights-per-category) util/vega-embed-opts]\n    ]\n\n   [:div#item-level-co2e-since-inception.content.tab-content-co2e-since-inception {:style {:display \"none\"}}\n    [:p \"The \" [:b \"total CO\" [:sub \"2\"] \"e\"] \" (in terms of flights) of the items of furniture sold (Mar 2017-Aug 2019) in each \" [:b \"sub-category\"] \".\"]\n    hint\n    [oz/vega-lite (chart-spec-item-level flights-per-item) util/vega-embed-opts]\n    ]\n\n   ]\n  )\n\n(defn root []\n      [tabbed-area\n       @state/ace-furniture-derivation-flights-per-category-cursor\n       @state/ace-furniture-derivation-flights-per-item-cursor])\n\n\n"]}