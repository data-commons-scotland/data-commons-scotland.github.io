{"version":3,"sources":["dcs/prototype_6/view/stirling_community_food/footfall.cljs"],"mappings":";AASA,AAAA,AAAMA,AACCC;AADP,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAM4BA;;AA0B5B,AAAA,AAAMC,AACCD;AADP,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAMwBA;;AAsBxB,AAAA,AAAME,AACCF;AADP,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAM4BA;;AAmB5B,AAAA,AAAMG,AAAQC;AAAd,AACM,AAAMC,AAAWD;AAAjB,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAQUE,AAAa,AAACP,AAAmBM,AACjCE,AAMoC,AAAA,AAACC,AASrCF,AAAa,AAACL,AAAmCI,AACjDE,AAEAD,AAAa,AAACJ,AAAyBG,AACvCE;;AAEhB,AAAA,AAAMG;AAAN,AAAA,AAAA,AAAAD,AACON,AACCQ","names":["dcs.prototype-6.view.stirling-community-food.footfall/chart-spec-per-day","data","dcs.prototype-6.view.stirling-community-food.footfall/chart-spec-period-in-day-per-month","dcs.prototype-6.view.stirling-community-food.footfall/chart-spec-day-per-month","dcs.prototype-6.view.stirling-community-food.footfall/charts","derivation","chart-data","oz.core/vega-lite","dcs.prototype-6.util/vega-embed-opts","goog.string/unescapeEntities","cljs.core/deref","dcs.prototype-6.view.stirling-community-food.footfall/root","dcs.prototype-6.state/stirling-community-food-footfall-derivation-cursor"],"sourcesContent":["(ns dcs.prototype-6.view.stirling-community-food.footfall\n  (:require\n    [reagent.core :as r]\n    [oz.core :as oz]\n    [goog.string :as gstring]\n    [dcs.prototype-6.util :as util]\n    [dcs.prototype-6.state :as state]))\n\n\n(defn chart-spec-per-day\n      [data]\n      {:schema     \"https://vega.github.io/schema/vega/v5.json\"\n       :width      30\n       :height     200\n       :background \"floralwhite\"\n       :data       {:values data}\n       :transform  [{:aggregate [{:op \"sum\" :field \"footfall\" :as \"footfall\"}]\n                     :groupby [\"day\" \"period-in-day\"]}]\n       :mark       {:type \"bar\"\n                    :cornerRadiusTopLeft  3\n                    :cornerRadiusTopRight 3}\n       :encoding   {:column {:field \"day\" :type \"nominal\"\n                             :sort {:op \"sum\" :field \"footfall\" :order \"descending\"}\n                             :axis {:title nil}}\n                    :x       {:field \"period-in-day\" :type \"nominal\"\n                              :sort [\"Morning\" \"Evening\"]\n                              :axis {:title nil\n                                     :labelAngle 60\n                                     :labelBound 45}}\n                    :y       {:field \"footfall\" :type \"quantitative\"}\n                    :color {:field \"period-in-day\" :type \"nominal\"\n                            :scale {:domain [\"Morning\"\n                                             \"Evening\"]\n                                    :range  [\"#8DD9E3\"\n                                             \"#E8CAE3\"]}\n                            :legend nil #_{:title \"period in day\" :symbolType \"circle\"\n                                     :orient \"bottom\"}}\n                    :tooltip [{:field \"period-in-day\" :type \"nominal\" :title \"period in day\"}\n                              {:field \"day\" :type \"nominal\"}\n                              {:field \"footfall\" :type \"quantitative\"}]}})\n\n(defn chart-spec-period-in-day-per-month\n      [data]\n  {:schema     \"https://vega.github.io/schema/vega/v5.json\"\n   :width      370\n   :height     200\n   :background \"floralwhite\"\n   :data       {:values data}\n   :transform  [{:timeUnit \"yearmonth\" :field \"yyyy-MM-dd\" :as \"month\"}\n                {:aggregate [{:op \"sum\" :field \"footfall\" :as \"footfall\"}]\n                 :groupby [\"month\" \"period-in-day\"]}]\n   :mark       {:type \"line\"\n                :point {:filled false :fill \"floralwhite\"}}\n   :encoding   {:x       {:field \"month\" :type \"temporal\"\n                          :axis {:format \"%b %y\"\n                                 :labelAngle 60\n                                 :labelBound 45}}\n                :y       {:field \"footfall\" :type \"quantitative\"}\n                :color   {:field \"period-in-day\" :type \"nominal\"\n                          :scale {:domain [\"Morning\"\n                                           \"Evening\"]\n                                  :range  [\"#8DD9E3\"\n                                           \"#E8CAE3\"]}\n                          :legend {:title \"period in day\"\n                                   :orient \"bottom\"}}\n                :tooltip [{:field \"period-in-day\" :type \"nominal\" :title \"period in day\"}\n                          {:field \"month\" :type \"temporal\" :format \"%b %Y\"}\n                          {:field \"footfall\" :type \"quantitative\"}]}})\n\n(defn chart-spec-day-per-month\n      [data]\n      {:schema     \"https://vega.github.io/schema/vega/v5.json\"\n       :width      370\n       :height     200\n       :background \"floralwhite\"\n       :data       {:values data}\n       :transform  [{:timeUnit \"yearmonth\" :field \"yyyy-MM-dd\" :as \"month\"}\n                    {:aggregate [{:op \"sum\" :field \"footfall\" :as \"footfall\"}]\n                     :groupby [\"month\" \"day\"]}]\n       :mark       {:type \"line\"\n                    :point {:filled false :fill \"floralwhite\"}}\n       :encoding   {:x       {:field \"month\" :type \"temporal\"\n                              :axis {:format \"%b %y\"\n                                     :labelAngle 60\n                                     :labelBound 45}}\n                    :y       {:field \"footfall\" :type \"quantitative\" :scale {:zero false}}\n                    :color   {:field \"day\" :type \"nominal\"\n                              :scale {:scheme \"tableau20\"}\n                              :legend {:orient \"bottom\"}}\n                    :tooltip [{:field \"day\" :type \"nominal\"}\n                              {:field \"month\" :type \"temporal\" :format \"%b %Y\"}\n                              {:field \"footfall\" :type \"quantitative\"}]}})\n\n\n(defn charts [derivation]\n      (let [chart-data derivation]\n\n           [:div.tile.is-ancestor\n\n            [:div.tile.is-6\n             [:div.tile.is-vertical.is-parent\n\n              [:div.tile.is-child\n               [oz/vega-lite (chart-spec-per-day chart-data)\n                util/vega-embed-opts]]\n              [:div.tile.is-child.content\n               [:p \"The graph above, shows that there is\n               no significant differences in footfall between days of the week.\n               (Days to the left have a higher overall footfall then days to the right.)\"]\n               [:p \"The next graph provides a month-by-month breakdown of footfall.\n               Did evening opening cease after Dec\" (gstring/unescapeEntities \"&nbsp;\") \"20? [...\\\"\" [:em \"yes\"] \"\\\"]\"]\n               [:p \"The graph after that, provides a month-by-month breakdown\n               of the footfall per day-of-the-week. There is no discernible\n               correlation between a day-of-the-week and a month-of-the-year.\"]]]]\n\n            [:div.tile\n             [:div.tile.is-vertical.is-parent\n\n              [:div.tile.is-child\n               [oz/vega-lite (chart-spec-period-in-day-per-month chart-data)\n                util/vega-embed-opts]]\n              [:div.tile.is-child\n               [oz/vega-lite (chart-spec-day-per-month chart-data)\n                util/vega-embed-opts]]]]]))\n\n(defn root []\n      [charts\n       @state/stirling-community-food-footfall-derivation-cursor])"]}