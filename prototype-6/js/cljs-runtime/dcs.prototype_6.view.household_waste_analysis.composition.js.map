{"version":3,"sources":["dcs/prototype_6/view/household_waste_analysis/composition.cljs"],"mappings":";AAOA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAKA;AAEL,AAAA,AAAMC,AACHC,AAAWC;AADd,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAMeA,AACSD,AAQQF;;AAWhC,AAAA,AAAMI,AAAQC;AAAd,AACE,AAAMH,AAAWG;AAAjB,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAGKC,AAAa,AAAA,AAACL,AAAWC,AACzBK,AAQS,AAAA,AAACC,AAAmE,AAAA,AAACA;;AAIrF,AAAA,AAAME;AAAN,AAAA,AAAA,AAAAD,AACOL,AACCO","names":["dcs.prototype-6.view.household-waste-analysis.composition/stratum-labels","dcs.prototype-6.view.household-waste-analysis.composition/chart-spec","chart-data","title","dcs.prototype-6.view.household-waste-analysis.composition/charts","derivation","oz.core/vega-lite","dcs.prototype-6.util/vega-embed-opts","goog.string/unescapeEntities","cljs.core/deref","dcs.prototype-6.view.household-waste-analysis.composition/root","dcs.prototype-6.state/household-waste-analysis-derivation-cursor"],"sourcesContent":["(ns dcs.prototype-6.view.household-waste-analysis.composition\n  (:require\n   [oz.core :as oz]\n   [goog.string :as gstring]\n   [dcs.prototype-6.util :as util]\n   [dcs.prototype-6.state :as state]))\n\n(def stratum-labels [\"urban \u00a3\" \"urban \u00a3\u00a3\" \"urban \u00a3\u00a3\u00a3\" \"rural \u00a3/\u00a3\u00a3\" \"rural \u00a3\u00a3\u00a3\"])\n\n(defn chart-spec\n  [chart-data title]\n  {:schema     \"https://vega.github.io/schema/vega/v5.json\"\n   :background \"#f2dfce\"\n   :width      400\n   :height     250\n   :title      title\n   :data       {:values chart-data}\n   :transform  [{:aggregate [{:op \"sum\" :field \"kgPerHhPerWk\" :as \"kgPer2Wks\"}]\n                 :groupby [\"stratum\" \"material-L1\"]}\n                {:calculate \"datum.kgPer2Wks / 2\" :as \"kg\"}] ;; to average over the 2 phases\n   :mark       {:type \"bar\"\n                :cornerRadiusTopLeft 3\n                :cornerRadiusTopRight 3}\n   :encoding   {:x       {:field \"stratum\" :type \"nominal\"\n                          :sort stratum-labels\n                          :axis {:title \"household type (location type & council tax band)\"\n                                 :labelAngle 0}}\n                :y       {:field \"kg\" :type \"quantitative\"\n                          :axis {:title \"average kg/hh/wk\"}}\n                :color {:field \"material-L1\" :type \"nominal\"\n                        :legend {:title \"material (high level)\"}}\n                :tooltip [{:field \"stratum\" :type \"nominal\" :title \"house type (location & CTax)\"}\n                          {:field \"material-L1\" :type \"nominal\" :title \"material (high level)\"}\n                          {:field \"kg\" :type \"quantitative\" :format \".3f\" :title \"avg kg per household per wk\"}]}})\n\n(defn charts [derivation]\n  (let [chart-data derivation]\n    [:div.columns\n     [:column\n      [oz/vega-lite (chart-spec chart-data \"Graph 1: Materials per household type\")\n       util/vega-embed-opts]\n      ]\n     [:column\n      [:div.m-4.content\n       [:p.has-text-info.has-text-weight-bold \"Hover/click on part of the graph to be shown more detail.\"]\n       [:p \"Graph 1 shows that \" [:span.has-text-warning \"Food wastes\"] \" and \" [:span.has-text-warning \"Paper and cardboard\"] \n        \" form significant components of binned material, across all 5 household types.\"]\n       [:p [:span.has-text-warning \"rural \u00a3/\u00a3\u00a3\"]\" households dispose of a lot of fine-grained material,\" \n        \" i.e.\" (gstring/unescapeEntities \"&nbsp;\") [:span.has-text-warning \"Fines\" (gstring/unescapeEntities \"&nbsp;\") \"(<10mm)\"] \".\"\n        \" ...What is it? ...Soil/dust/dirt?\"]\n       ]]]))\n\n(defn root []\n      [charts\n       @state/household-waste-analysis-derivation-cursor])"]}