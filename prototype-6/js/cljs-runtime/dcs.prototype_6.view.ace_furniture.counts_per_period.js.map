{"version":3,"sources":["dcs/prototype_6/view/ace_furniture/counts_per_period.cljs"],"mappings":";AAUA,AAAA,AAAMA,AACCC;AADP,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAI4BA,AACT,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAACC,AAAKC;;AAqCzB,AAAA,AAAMC,AACCH;AADP,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAI4BA,AACT,AAAA,AAAA,AAAA,AAAA,AAAA,AAACC,AAAKC;;AAoCzB,AAAA,AAAME,AAAaC;AAAnB,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAIyD,AAAKC;AAAL,AAAQ,AAAA,AAAA,AAACC,AAAcD;AAJhF,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAK+C,AAAKA;AAAL,AAAQ,AAAA,AAAA,AAACC,AAAcD;AALtE,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAUSE,AAAa,AAACT,AAA0BM,AAAQI,AAMhDD,AAAa,AAACL,AAAsBE,AAAQI;;AAOrD,AAAA,AAAME;AAAN,AAAA,AAAA,AAAAD,AACON,AACCQ","names":["dcs.prototype-6.view.ace-furniture.counts-per-period/chart-spec-category-level","data","cljs.core.conj","dcs.prototype-6.view.ace-furniture.shared/transform-spec","dcs.prototype-6.view.ace-furniture.counts-per-period/chart-spec-item-level","dcs.prototype-6.view.ace-furniture.counts-per-period/tabbed-area","counts","e","dcs.prototype-6.util/open-tab","oz.core/vega-lite","dcs.prototype-6.util/vega-embed-opts","cljs.core/deref","dcs.prototype-6.view.ace-furniture.counts-per-period/root","dcs.prototype-6.state/ace-furniture-counts-derivation-cursor"],"sourcesContent":["(ns dcs.prototype-6.view.ace-furniture.counts-per-period\n  (:require\n    [reagent.core :as r]\n    [oz.core :as oz]\n    [goog.string :as gstring]\n    [dcs.prototype-6.util :as util]\n    [dcs.prototype-6.state :as state]\n    [dcs.prototype-6.view.ace-furniture.shared :as shared]))\n\n\n(defn chart-spec-category-level\n      [data]\n      {:schema     \"https://vega.github.io/schema/vega/v5.json\"\n       :background \"floralwhite\"\n       :data       {:values data}\n       :transform  (conj shared/transform-spec\n                         {:aggregate [{:op \"sum\" :field \"count\" :as \"count\"}]\n                          :groupby [\"instant\" \"period\" \"category\"]}\n                         {:calculate \"truncate(datum.category, 30)\" :as \"categorytruncated\"})\n       :facet   {:field \"categorytruncated\"\n                 :type \"nominal\"\n                 :sort {:field \"count\" :op \"sum\" :order \"descending\"}\n                 :header {:title \"category\" :titlePadding 30}}\n       :columns    4\n       :bounds \"flush\"\n       :spacing 35\n       ;:resolve {:axis {:x \"independent\" :y \"independent\"}}\n       :spec       {:width 130\n                    :height 50\n                    :layer [{:mark {:type \"line\"\n                                    :point {:filled false :fill \"#f2dfce\"}}\n                             :encoding   {:x       {:field \"instant\" :type \"temporal\"\n                                                    :axis {:title nil\n                                                           :format \"%b %y\"\n                                                           :labelAngle 90\n                                                           ;:labelBound 45\n                                                           }\n                                                    }\n                                          :y       {:field \"count\" :type \"quantitative\"\n                                                    :axis {:title nil}\n                                                    :scale {:type \"log\"}\n                                                    }\n                                          :color   {:value \"#B46E6F\"}\n                                          :tooltip [{:title \"category\" :field \"category\" :type \"nominal\"}\n                                                    {:title \"period\" :field \"period\" :type \"nominal\"}\n                                                    {:title \"count\" :field \"count\" :type \"quantitative\"}]}\n\n                             }]\n                    }\n       })\n\n\n(defn chart-spec-item-level\n      [data]\n      {:schema     \"https://vega.github.io/schema/vega/v5.json\"\n       :background \"floralwhite\"\n       :data       {:values data}\n       :transform  (conj shared/transform-spec\n                         {:calculate \"truncate(datum.item, 30)\" :as \"itemtruncated\"})\n       :facet   {:field \"itemtruncated\"\n                 :type \"nominal\"\n                 :sort {:field \"count\" :op \"sum\" :order \"descending\"}\n                 :header {:title \"item\" :titlePadding 30}}\n       :columns    5\n       :bounds \"flush\"\n       :spacing 35\n       ;:resolve {:axis {:x \"independent\" :y \"independent\"}}\n       :spec       {:width 130\n                    :height 50\n                    :layer [{:mark {:type \"line\"\n                                    :point {:filled false :fill \"#f2dfce\"}}\n                             :encoding   {:x       {:field \"instant\" :type \"temporal\"\n                                                    :axis {:title nil\n                                                           :format \"%b %y\"\n                                                           :labelAngle 90\n                                                           ;:labelBound 45\n                                                           }\n                                                    }\n                                          :y       {:field \"count\" :type \"quantitative\"\n                                                    :axis {:title nil}\n                                                    :scale {:type \"log\"}\n                                                    }\n                                          :color   {:value \"#B46E6F\"}\n                                          :tooltip [{:title \"category\" :field \"category\" :type \"nominal\"}\n                                                    {:title \"item\" :field \"item\" :type \"nominal\"}\n                                                    {:title \"period\" :field \"period\" :type \"nominal\"}\n                                                    {:title \"count\" :field \"count\" :type \"quantitative\"}]}\n\n                             }]\n                    }\n       })\n\n\n(defn tabbed-area [counts]\n      [:div\n       [:div.tabs\n        [:ul\n         [:li.tab-counts-per-period.is-active {:on-click (fn [e] (util/open-tab e \"counts-per-period\" \"category-level\"))} [:a \"Less detail\"]]\n         [:li.tab-counts-per-period {:on-click (fn [e] (util/open-tab e \"counts-per-period\" \"item-level\"))} [:a \"More detail\"]]]]\n\n\n       [:div#category-level-counts-per-period.content.tab-content-counts-per-period\n        [:p \"Less detail\"]\n        [oz/vega-lite (chart-spec-category-level counts) util/vega-embed-opts]\n        ]\n\n\n       [:div#item-level-counts-per-period.content.tab-content-counts-per-period {:style {:display \"none\"}}\n        [:p \"More detail\"]\n        [oz/vega-lite (chart-spec-item-level counts) util/vega-embed-opts]\n        ]\n\n\n       ]\n      )\n\n(defn root []\n      [tabbed-area\n       @state/ace-furniture-counts-derivation-cursor])"]}