{"version":3,"sources":["dcs/prototype_6/view/household_waste_analysis/disposal.cljs"],"mappings":";AAOA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAKA;AAEL,AAAA,AAAMC,AACCC,AAAWC;AADlB,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAKmBA,AACSD,AAMSF;;AA2BrC,AAAA,AAAMI,AAAQC;AAAd,AACE,AAAMH,AAAWG;AAAjB,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAGKC,AAAa,AAAA,AAACL,AAAWC,AACzBK,AAMiC,AAAA,AAACC,AAAyC,AAAA,AAACA,AAAuC,AAAA,AAACA,AAEnF,AAAA,AAACA,AAAyC,AAAA,AAACA,AAAuC,AAAA,AAACA;;AAI3H,AAAA,AAAME;AAAN,AAAA,AAAA,AAAAD,AACOL,AACCO","names":["dcs.prototype-6.view.household-waste-analysis.disposal/stratum-labels","dcs.prototype-6.view.household-waste-analysis.disposal/chart-spec","chart-data","title","dcs.prototype-6.view.household-waste-analysis.disposal/charts","derivation","oz.core/vega-lite","dcs.prototype-6.util/vega-embed-opts","goog.string/unescapeEntities","cljs.core/deref","dcs.prototype-6.view.household-waste-analysis.disposal/root","dcs.prototype-6.state/household-waste-analysis-derivation-cursor"],"sourcesContent":["(ns dcs.prototype-6.view.household-waste-analysis.disposal\n  (:require\n   [oz.core :as oz]\n   [goog.string :as gstring]\n   [dcs.prototype-6.util :as util]\n   [dcs.prototype-6.state :as state]))\n\n(def stratum-labels [\"urban \u00a3\" \"urban \u00a3\u00a3\" \"urban \u00a3\u00a3\u00a3\" \"rural \u00a3/\u00a3\u00a3\" \"rural \u00a3\u00a3\u00a3\"])\n\n(defn chart-spec\n      [chart-data title]\n      {:schema     \"https://vega.github.io/schema/vega/v5.json\"\n       :background \"#fff1e5\"\n       :config {:title {:anchor \"center\"}}\n       :title      title\n       :data       {:values chart-data}\n       :transform  [{:calculate \"datum.stream + (datum.stream == datum.idealStream ? ' - appropriate' : ' - inappropriate')\" :as \"stream\"}\n                    {:aggregate [{:op \"sum\" :field \"kgPerHhPerWk\" :as \"kgPer2Wks\"}]\n                     :groupby   [\"stratum\" \"stream\"]}\n                    {:calculate \"datum.kgPer2Wks / 2\" :as \"kg\"}] ;; to average over the 2 phases\n       :facet      {:column {:field  \"stratum\" :type \"nominal\"\n                             :sort   stratum-labels\n                             :header {:title \"household type (location type & council tax band)\"\n                                      :titleOrient \"bottom\"\n                                      :labelPadding -170}}} ;; hack to workaround labelOrient problem\n       :spec       {:width  80\n                    :height 150\n                    :mark     {:type \"bar\"}\n                    :encoding {:x           {:field \"stream\" :type \"nominal\"\n                                             :axis  nil}\n                               :y           {:field \"kg\" :type \"quantitative\"\n                                             :axis  {:title \"average kg/hh/wk\"}}\n                               :color {:field \"stream\" :type \"nominal\"\n                                       :scale {:domain [\"grey bin - appropriate\"\n                                                        \"grey bin - inappropriate\"\n                                                        \"recycling bin - appropriate\"\n                                                        \"recycling bin - inappropriate\"]\n                                               :range [\"#928E85\"\n                                                       \"#BF5748\"\n                                                       \"#7FD1AE\"\n                                                       \"#FD8D58\"]}\n                                       :legend {:title \"disposal\"}}\n                               :tooltip     [{:field \"stratum\" :type \"nominal\" :title \"house type (location & CTax)\"}\n                                             {:field \"stream\" :type \"nominal\" :title \"disposal\"}\n                                             {:field \"kg\" :type \"quantitative\" :title \"avg kg per household per wk\"}]}}})\n\n\n\n(defn charts [derivation]\n  (let [chart-data derivation]\n    [:div.columns\n     [:column\n      [oz/vega-lite (chart-spec chart-data \"Graph 2: Disposal decisions per household type\")\n       util/vega-embed-opts]\n      ]\n     [:column\n      [:div.m-4.content\n        [:p \"Graph 2 suggested that the majority of grey bin content should be disposed of via different means:\"\n         \" compare the relative heights of the \" \n         [:span.has-text-warning \"grey\" (gstring/unescapeEntities \"&nbsp;\") \"bin\" (gstring/unescapeEntities \"&nbsp;\") \"-\" (gstring/unescapeEntities \"&nbsp;\") \"appropriate\"] \n         \" vs \" \n         [:span.has-text-warning \"grey\" (gstring/unescapeEntities \"&nbsp;\") \"bin\" (gstring/unescapeEntities \"&nbsp;\") \"-\" (gstring/unescapeEntities \"&nbsp;\") \"inappropriate\"]\n         \" graph bars.\"]\n       ]]]))\n\n(defn root []\n      [charts\n       @state/household-waste-analysis-derivation-cursor])\n"]}