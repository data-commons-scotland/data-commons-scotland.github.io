{"version":3,"sources":["dcs/prototype_6/view/regional_dashboard/region_position.cljs"],"mappings":"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","names":["dcs.prototype-6.view.regional-dashboard.region-position/colour","n","dcs.prototype-6.view.regional-dashboard.region-position/suffix","s","clojure.string/ends-with?","dcs.prototype-6.view.regional-dashboard.region-position/ele","region","household-waste-derivation-generation-positions","household-waste-derivation-percent-recycled-positions","household-co2e-derivation-generation-positions","annotations","cljs.core.repeat","goog.string/unescapeEntities","latest-position","p1__37477#","cljs.core.filter","cljs.core._EQ_","cljs.core/first","trend-position","p1__37478#","anno","dcs.prototype-6.annotation-mech/first-annotation-whose-record-criteria-matches","dcs.prototype-6.annotation-mech/vega-like-tooltip","cljs.core.get","dcs.prototype-6.annotation-mech/default-annotation-symbol","p1__37482#","p1__37483#","p1__37485#","p1__37486#","cljs.core/deref","dcs.prototype-6.view.regional-dashboard.region-position/root","dcs.prototype-6.state/region-cursor","dcs.prototype-6.state/household-waste-derivation-generation-positions-cursor","dcs.prototype-6.state/household-waste-derivation-percent-recycled-positions-cursor","dcs.prototype-6.state/household-co2e-derivation-generation-positions-cursor","dcs.prototype-6.state/annotations-derivation-cursor"],"sourcesContent":["(ns dcs.prototype-6.view.regional-dashboard.region-position\n  (:require [clojure.string :as str]\n            [goog.string :as gstring]\n            [dcs.prototype-6.annotation-mech :as anno-mech]\n            [dcs.prototype-6.state :as state]))\n\n(defn colour [n]\n      (if (< n 17)\n        \"has-text-success-dark\"\n        \"has-text-danger-dark\"))\n\n(defn suffix [n]\n      (let [s (str n)]\n           (cond\n             (str/ends-with? s \"11\") \"th\"\n             (str/ends-with? s \"12\") \"th\"\n             (str/ends-with? s \"13\") \"th\"\n             (str/ends-with? s \"1\") \"st\"\n             (str/ends-with? s \"2\") \"nd\"\n             :else \"th\")))\n\n(defn ele [region\n           household-waste-derivation-generation-positions\n           household-waste-derivation-percent-recycled-positions\n           household-co2e-derivation-generation-positions\n           annotations]\n\n      [:div\n       [:table#league-table.table.is-hoverable\n        [:thead\n         [:tr\n          [:th \"\"]\n          [:th {:colSpan 2} \"Position\"]\n           [:th \"\"]]\n         [:tr\n          [:th \"Aim\"]\n          [:th \"Trend\"]\n          [:th \"Latest\"]\n           [:th (repeat 14 (gstring/unescapeEntities \"&nbsp;\"))]]]\n\n        [:tbody\n\n         (let [latest-position (->> household-waste-derivation-generation-positions\n                                    :latest-positions\n                                    (filter #(= region (:region %)))\n                                    first\n                                    :position)\n               trend-position (->> household-waste-derivation-generation-positions\n                                   :trend-positions\n                                   (filter #(= region (:region %)))\n                                   first\n                                   :position)\n               anno (anno-mech/first-annotation-whose-record-criteria-matches annotations\n                                                                              {:record-type :household-waste-derivation-generation-positions\n                                                                               :region      region})]\n              [:tr [:td \"Reduce waste generation\"]\n               [:td {:class (colour trend-position)} (str trend-position (suffix trend-position))]\n               [:td {:class (colour latest-position)} (str latest-position (suffix latest-position))]\n               [:td (when anno\n                      (anno-mech/vega-like-tooltip (get anno :emoji anno-mech/default-annotation-symbol) (:text anno)))]])\n\n         (let [latest-position (->> household-co2e-derivation-generation-positions\n                                    :latest-positions\n                                    (filter #(= region (:region %)))\n                                    first\n                                    :position\n                                    )\n               trend-position (->> household-co2e-derivation-generation-positions\n                                   :trend-positions\n                                   (filter #(= region (:region %)))\n                                   first\n                                   :position)\n               anno (anno-mech/first-annotation-whose-record-criteria-matches annotations\n                                                                              {:record-type :household-co2e-derivation-generation-positions\n                                                                               :region      region})]\n              [:tr [:td \"Reduce carbon impact\"]\n               [:td {:class (colour trend-position)} (str trend-position (suffix trend-position))]\n               [:td {:class (colour latest-position)} (str latest-position (suffix latest-position))]\n               [:td (when anno\n                      (anno-mech/vega-like-tooltip (get anno :emoji anno-mech/default-annotation-symbol) (:text anno)))]])\n\n         (let [latest-position (->> household-waste-derivation-percent-recycled-positions\n                                    :latest-positions\n                                    (filter #(= region (:region %)))\n                                    first\n                                    :position)\n               trend-position (->> household-waste-derivation-percent-recycled-positions\n                                   :trend-positions\n                                   (filter #(= region (:region %)))\n                                   first\n                                   :position)\n               anno (anno-mech/first-annotation-whose-record-criteria-matches annotations\n                                                                              {:record-type :household-waste-derivation-percent-recycled-positions\n                                                                               :region      region})]\n              [:tr [:td \"Increase percentage recycled\"]\n               [:td {:class (colour trend-position)} (str trend-position (suffix trend-position))]\n               [:td {:class (colour latest-position)} (str latest-position (suffix latest-position))]\n               [:td (when anno\n                      (anno-mech/vega-like-tooltip (get anno :emoji anno-mech/default-annotation-symbol) (:text anno)))]])]]])\n\n\n(defn root []\n      [ele\n       @state/region-cursor\n       @state/household-waste-derivation-generation-positions-cursor\n       @state/household-waste-derivation-percent-recycled-positions-cursor\n       @state/household-co2e-derivation-generation-positions-cursor\n       @state/annotations-derivation-cursor])\n\n"]}